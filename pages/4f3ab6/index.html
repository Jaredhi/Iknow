<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginxé…ç½®è¯¦è§£ | Jared&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="https://www.jaredh.cn/.vuepress/public/img/%E7%BA%B8%E9%A3%9E%E6%9C%BA.png">
    <meta name="description" content="çŸ¥è¯†ç§¯ç´¯åº“">
    <meta name="keywords" content="ä¸ªäººæŠ€æœ¯åšå®¢,å…¨æ ˆ,å…¨æ ˆå¼€å‘,DevOps,æ¡†æ¶,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,Java,Spring,TypeScript,vue,git,markdown">
    <meta name="theme-color" content="#1166cd">
    <link rel="preload" href="/assets/css/0.styles.44d0f432.css" as="style"><link rel="preload" href="/assets/js/app.dce23f32.js" as="script"><link rel="preload" href="/assets/js/2.0a476569.js" as="script"><link rel="preload" href="/assets/js/3.03310ead.js" as="script"><link rel="preload" href="/assets/js/59.681ea709.js" as="script"><link rel="prefetch" href="/assets/js/10.be7f436c.js"><link rel="prefetch" href="/assets/js/100.c5faf45f.js"><link rel="prefetch" href="/assets/js/101.42e0ac50.js"><link rel="prefetch" href="/assets/js/102.bb14e64b.js"><link rel="prefetch" href="/assets/js/103.81bf3c7c.js"><link rel="prefetch" href="/assets/js/104.d1c8d8f0.js"><link rel="prefetch" href="/assets/js/105.d7aa788f.js"><link rel="prefetch" href="/assets/js/106.39cb6fdd.js"><link rel="prefetch" href="/assets/js/107.b26b0841.js"><link rel="prefetch" href="/assets/js/108.41d302aa.js"><link rel="prefetch" href="/assets/js/109.f4382788.js"><link rel="prefetch" href="/assets/js/11.32bd7745.js"><link rel="prefetch" href="/assets/js/110.3d84f092.js"><link rel="prefetch" href="/assets/js/111.2c7a7ff1.js"><link rel="prefetch" href="/assets/js/112.23adafb9.js"><link rel="prefetch" href="/assets/js/113.f6aeaecd.js"><link rel="prefetch" href="/assets/js/114.2012c13a.js"><link rel="prefetch" href="/assets/js/115.bf3e2dbe.js"><link rel="prefetch" href="/assets/js/116.3bd9a150.js"><link rel="prefetch" href="/assets/js/117.ab19fd54.js"><link rel="prefetch" href="/assets/js/118.9ad186b9.js"><link rel="prefetch" href="/assets/js/119.a193d528.js"><link rel="prefetch" href="/assets/js/12.ef6ddb2c.js"><link rel="prefetch" href="/assets/js/120.c614caf0.js"><link rel="prefetch" href="/assets/js/121.5b0e0013.js"><link rel="prefetch" href="/assets/js/13.35718513.js"><link rel="prefetch" href="/assets/js/14.278daae5.js"><link rel="prefetch" href="/assets/js/15.075b8007.js"><link rel="prefetch" href="/assets/js/16.e764165f.js"><link rel="prefetch" href="/assets/js/17.0dde71b9.js"><link rel="prefetch" href="/assets/js/18.952ee688.js"><link rel="prefetch" href="/assets/js/19.d3d3a5e3.js"><link rel="prefetch" href="/assets/js/20.0cce088c.js"><link rel="prefetch" href="/assets/js/21.7f609d23.js"><link rel="prefetch" href="/assets/js/22.ff109b73.js"><link rel="prefetch" href="/assets/js/23.22e55119.js"><link rel="prefetch" href="/assets/js/24.478b668f.js"><link rel="prefetch" href="/assets/js/25.40934b51.js"><link rel="prefetch" href="/assets/js/26.a8915e14.js"><link rel="prefetch" href="/assets/js/27.9511311d.js"><link rel="prefetch" href="/assets/js/28.6fb9c9bb.js"><link rel="prefetch" href="/assets/js/29.6596af6d.js"><link rel="prefetch" href="/assets/js/30.e47e8fc2.js"><link rel="prefetch" href="/assets/js/31.5054b3ba.js"><link rel="prefetch" href="/assets/js/32.ef73b689.js"><link rel="prefetch" href="/assets/js/33.02c0883b.js"><link rel="prefetch" href="/assets/js/34.d46d5592.js"><link rel="prefetch" href="/assets/js/35.575c59a9.js"><link rel="prefetch" href="/assets/js/36.763c2ec0.js"><link rel="prefetch" href="/assets/js/37.ff0010d5.js"><link rel="prefetch" href="/assets/js/38.f68cf0f1.js"><link rel="prefetch" href="/assets/js/39.52ce0e61.js"><link rel="prefetch" href="/assets/js/4.12ba5ea4.js"><link rel="prefetch" href="/assets/js/40.f682666a.js"><link rel="prefetch" href="/assets/js/41.a89c7af8.js"><link rel="prefetch" href="/assets/js/42.e6b5082b.js"><link rel="prefetch" href="/assets/js/43.5c70f9c4.js"><link rel="prefetch" href="/assets/js/44.d423d97b.js"><link rel="prefetch" href="/assets/js/45.3accf45c.js"><link rel="prefetch" href="/assets/js/46.adead9ed.js"><link rel="prefetch" href="/assets/js/47.45febb5f.js"><link rel="prefetch" href="/assets/js/48.91e54ab7.js"><link rel="prefetch" href="/assets/js/49.b6bdbd76.js"><link rel="prefetch" href="/assets/js/5.b2da7372.js"><link rel="prefetch" href="/assets/js/50.3a045da3.js"><link rel="prefetch" href="/assets/js/51.a2eae4fb.js"><link rel="prefetch" href="/assets/js/52.a0f21da8.js"><link rel="prefetch" href="/assets/js/53.62b2f532.js"><link rel="prefetch" href="/assets/js/54.f893c428.js"><link rel="prefetch" href="/assets/js/55.50e21f24.js"><link rel="prefetch" href="/assets/js/56.98d91913.js"><link rel="prefetch" href="/assets/js/57.98167654.js"><link rel="prefetch" href="/assets/js/58.c1ddc2f0.js"><link rel="prefetch" href="/assets/js/6.1995ebab.js"><link rel="prefetch" href="/assets/js/60.df1b91b1.js"><link rel="prefetch" href="/assets/js/61.fabace57.js"><link rel="prefetch" href="/assets/js/62.29da048d.js"><link rel="prefetch" href="/assets/js/63.918fe3f6.js"><link rel="prefetch" href="/assets/js/64.12856044.js"><link rel="prefetch" href="/assets/js/65.6ebfb4a2.js"><link rel="prefetch" href="/assets/js/66.770ad29e.js"><link rel="prefetch" href="/assets/js/67.80bd9ed5.js"><link rel="prefetch" href="/assets/js/68.b55578de.js"><link rel="prefetch" href="/assets/js/69.fa66951c.js"><link rel="prefetch" href="/assets/js/7.9c6de7b0.js"><link rel="prefetch" href="/assets/js/70.bf0ffdac.js"><link rel="prefetch" href="/assets/js/71.40ba910e.js"><link rel="prefetch" href="/assets/js/72.8a811346.js"><link rel="prefetch" href="/assets/js/73.63d2cd5a.js"><link rel="prefetch" href="/assets/js/74.44ca88ab.js"><link rel="prefetch" href="/assets/js/75.d5548bc0.js"><link rel="prefetch" href="/assets/js/76.ecd79f6f.js"><link rel="prefetch" href="/assets/js/77.8fbe5c6a.js"><link rel="prefetch" href="/assets/js/78.005604f5.js"><link rel="prefetch" href="/assets/js/79.59585fa6.js"><link rel="prefetch" href="/assets/js/8.46697342.js"><link rel="prefetch" href="/assets/js/80.2088fa05.js"><link rel="prefetch" href="/assets/js/81.17d30c5d.js"><link rel="prefetch" href="/assets/js/82.a080e5a7.js"><link rel="prefetch" href="/assets/js/83.96495564.js"><link rel="prefetch" href="/assets/js/84.28381bdd.js"><link rel="prefetch" href="/assets/js/85.655161e7.js"><link rel="prefetch" href="/assets/js/86.34a8880c.js"><link rel="prefetch" href="/assets/js/87.a407b8ed.js"><link rel="prefetch" href="/assets/js/88.da255f54.js"><link rel="prefetch" href="/assets/js/89.1f937db1.js"><link rel="prefetch" href="/assets/js/9.2980261e.js"><link rel="prefetch" href="/assets/js/90.44ed90c7.js"><link rel="prefetch" href="/assets/js/91.d0ebb249.js"><link rel="prefetch" href="/assets/js/92.fb7501ee.js"><link rel="prefetch" href="/assets/js/93.bf965309.js"><link rel="prefetch" href="/assets/js/94.08340d37.js"><link rel="prefetch" href="/assets/js/95.9a1cc6b8.js"><link rel="prefetch" href="/assets/js/96.aae0ce80.js"><link rel="prefetch" href="/assets/js/97.d7531130.js"><link rel="prefetch" href="/assets/js/98.f247833a.js"><link rel="prefetch" href="/assets/js/99.09ceb6de.js">
    <link rel="stylesheet" href="/assets/css/0.styles.44d0f432.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://www.jaredh.cn/public/gif/go.gif" alt="Jared's blog" class="logo"> <span class="site-name can-hide">Jared's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç¨‹åŸºç¡€" class="dropdown-title"><a href="/codeBasics/" class="link-title">ç¼–ç¨‹åŸºç¡€</a> <span class="title" style="display:none;">ç¼–ç¨‹åŸºç¡€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/cad62e/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/c47e12/" class="nav-link">æ•°æ®ç»“æ„ä¸ç®—æ³•</a></li><li class="dropdown-item"><!----> <a href="/pages/41a364/" class="nav-link">è®¡ç®—æœºç½‘ç»œ</a></li><li class="dropdown-item"><!----> <a href="/pages/15ab06/" class="nav-link">æ“ä½œç³»ç»Ÿ</a></li><li class="dropdown-item"><!----> <a href="/pages/1e979a/" class="nav-link">æ•°æ®åº“SQL</a></li><li class="dropdown-item"><!----> <a href="/pages/b5c9b5/" class="nav-link">è®¾è®¡æ¨¡å¼</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç ”å‘å·¥å…·" class="dropdown-title"><a href="/R&amp;D-Tools/" class="link-title">ç ”å‘å·¥å…·</a> <span class="title" style="display:none;">ç ”å‘å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4d971e/" class="nav-link">é›†æˆå¼€å‘ç¯å¢ƒ</a></li><li class="dropdown-item"><!----> <a href="/pages/8a8aed/" class="nav-link">Linuxç³»ç»Ÿ</a></li><li class="dropdown-item"><!----> <a href="/pages/3a1708/" class="nav-link">ä»£ç ç®¡ç†</a></li><li class="dropdown-item"><!----> <a href="/pages/40b1d2/" class="nav-link">é¡¹ç›®ç®¡ç†</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åº”ç”¨æ¡†æ¶" class="dropdown-title"><a href="/framework/" class="link-title">åº”ç”¨æ¡†æ¶</a> <span class="title" style="display:none;">åº”ç”¨æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>åç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/734f2c/" class="nav-link">ä¸­é—´ä»¶</a></li><li class="dropdown-subitem"><a href="/pages/42ed09/" class="nav-link">Springå®¶æ—</a></li><li class="dropdown-subitem"><a href="/pages/31cc55/" class="nav-link">æœåŠ¡å™¨è½¯ä»¶</a></li><li class="dropdown-subitem"><a href="/pages/8ec421/" class="nav-link">æ•°æ®åº“</a></li><li class="dropdown-subitem"><a href="/pages/4b933d/" class="nav-link">æœç´¢å¼•æ“</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">åˆ†å¸ƒå¼&amp;å¾®æœåŠ¡</a></li><li class="dropdown-subitem"><a href="/pages/91630a/" class="nav-link">å®¹å™¨åŒ–</a></li></ul></li><li class="dropdown-item"><h4>å‰ç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/5038fc/" class="nav-link">åŸºç¡€</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">æ¨¡æ¿æ¡†æ¶</a></li><li class="dropdown-subitem"><a href="/pages/99eb21/" class="nav-link">ç»„ä»¶åŒ–æ¡†æ¶</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è¿ç»´ç›¸å…³" class="dropdown-title"><a href="/ops/" class="link-title">è¿ç»´ç›¸å…³</a> <span class="title" style="display:none;">è¿ç»´ç›¸å…³</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/51470f/" class="nav-link">è¿ç»´çŸ¥è¯†</a></li><li class="dropdown-item"><!----> <a href="/pages/f1406d/" class="nav-link">éƒ¨ç½²å·¥å…·</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®" class="dropdown-title"><!----> <span class="title" style="display:;">é¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/079753/" class="nav-link">åœ¨çº¿æ•™è‚²</a></li><li class="dropdown-item"><!----> <a href="/pages/dd9f23/" class="nav-link">ç”µå•†</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶ä»–" class="dropdown-title"><!----> <span class="title" style="display:;">å…¶ä»–</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/3a5f05/" class="nav-link">ç–‘æƒ‘æ—¥å¿—</a></li><li class="dropdown-item"><!----> <a href="/pages/7176e3/" class="nav-link">éšç¬”</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><!----> <span class="title" style="display:;">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/link/" class="nav-link">å‹é“¾</a></li><li class="dropdown-item"><!----> <a href="/books/index.html" class="nav-link">ä¹¦ç±</a></li><li class="dropdown-item"><!----> <a href="/relaxation/index.html" class="nav-link">å¨±ä¹</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Jaredhi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/Jared-h" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/HIHE_i" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://jaredh.oss-cn-shenzhen.aliyuncs.com/public/img/me1.png"> <div class="blogger-info"><h3>    Jared H   </h3> <span>  ğŸ’»ğŸ¤£ğŸ˜œ  </span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç¨‹åŸºç¡€" class="dropdown-title"><a href="/codeBasics/" class="link-title">ç¼–ç¨‹åŸºç¡€</a> <span class="title" style="display:none;">ç¼–ç¨‹åŸºç¡€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/cad62e/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/c47e12/" class="nav-link">æ•°æ®ç»“æ„ä¸ç®—æ³•</a></li><li class="dropdown-item"><!----> <a href="/pages/41a364/" class="nav-link">è®¡ç®—æœºç½‘ç»œ</a></li><li class="dropdown-item"><!----> <a href="/pages/15ab06/" class="nav-link">æ“ä½œç³»ç»Ÿ</a></li><li class="dropdown-item"><!----> <a href="/pages/1e979a/" class="nav-link">æ•°æ®åº“SQL</a></li><li class="dropdown-item"><!----> <a href="/pages/b5c9b5/" class="nav-link">è®¾è®¡æ¨¡å¼</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç ”å‘å·¥å…·" class="dropdown-title"><a href="/R&amp;D-Tools/" class="link-title">ç ”å‘å·¥å…·</a> <span class="title" style="display:none;">ç ”å‘å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4d971e/" class="nav-link">é›†æˆå¼€å‘ç¯å¢ƒ</a></li><li class="dropdown-item"><!----> <a href="/pages/8a8aed/" class="nav-link">Linuxç³»ç»Ÿ</a></li><li class="dropdown-item"><!----> <a href="/pages/3a1708/" class="nav-link">ä»£ç ç®¡ç†</a></li><li class="dropdown-item"><!----> <a href="/pages/40b1d2/" class="nav-link">é¡¹ç›®ç®¡ç†</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åº”ç”¨æ¡†æ¶" class="dropdown-title"><a href="/framework/" class="link-title">åº”ç”¨æ¡†æ¶</a> <span class="title" style="display:none;">åº”ç”¨æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>åç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/734f2c/" class="nav-link">ä¸­é—´ä»¶</a></li><li class="dropdown-subitem"><a href="/pages/42ed09/" class="nav-link">Springå®¶æ—</a></li><li class="dropdown-subitem"><a href="/pages/31cc55/" class="nav-link">æœåŠ¡å™¨è½¯ä»¶</a></li><li class="dropdown-subitem"><a href="/pages/8ec421/" class="nav-link">æ•°æ®åº“</a></li><li class="dropdown-subitem"><a href="/pages/4b933d/" class="nav-link">æœç´¢å¼•æ“</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">åˆ†å¸ƒå¼&amp;å¾®æœåŠ¡</a></li><li class="dropdown-subitem"><a href="/pages/91630a/" class="nav-link">å®¹å™¨åŒ–</a></li></ul></li><li class="dropdown-item"><h4>å‰ç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/5038fc/" class="nav-link">åŸºç¡€</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">æ¨¡æ¿æ¡†æ¶</a></li><li class="dropdown-subitem"><a href="/pages/99eb21/" class="nav-link">ç»„ä»¶åŒ–æ¡†æ¶</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è¿ç»´ç›¸å…³" class="dropdown-title"><a href="/ops/" class="link-title">è¿ç»´ç›¸å…³</a> <span class="title" style="display:none;">è¿ç»´ç›¸å…³</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/51470f/" class="nav-link">è¿ç»´çŸ¥è¯†</a></li><li class="dropdown-item"><!----> <a href="/pages/f1406d/" class="nav-link">éƒ¨ç½²å·¥å…·</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¡¹ç›®" class="dropdown-title"><!----> <span class="title" style="display:;">é¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/079753/" class="nav-link">åœ¨çº¿æ•™è‚²</a></li><li class="dropdown-item"><!----> <a href="/pages/dd9f23/" class="nav-link">ç”µå•†</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶ä»–" class="dropdown-title"><!----> <span class="title" style="display:;">å…¶ä»–</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/3a5f05/" class="nav-link">ç–‘æƒ‘æ—¥å¿—</a></li><li class="dropdown-item"><!----> <a href="/pages/7176e3/" class="nav-link">éšç¬”</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><!----> <span class="title" style="display:;">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/link/" class="nav-link">å‹é“¾</a></li><li class="dropdown-item"><!----> <a href="/books/index.html" class="nav-link">ä¹¦ç±</a></li><li class="dropdown-item"><!----> <a href="/relaxation/index.html" class="nav-link">å¨±ä¹</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Jaredhi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/Jared-h" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/HIHE_i" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>åç«¯</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ä¸­é—´ä»¶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Springå®¶æ—</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>æœåŠ¡å™¨è½¯ä»¶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/31cc55/" class="sidebar-link">Nginx</a></li><li><a href="/pages/4f3ab6/" aria-current="page" class="active sidebar-link">Nginxé…ç½®è¯¦è§£</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#é»˜è®¤é…ç½®æ–‡ä»¶" class="sidebar-link">é»˜è®¤é…ç½®æ–‡ä»¶</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#é…ç½®æ–‡ä»¶ç»“æ„" class="sidebar-link">é…ç½®æ–‡ä»¶ç»“æ„</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#_1ã€main-å…¨å±€å—" class="sidebar-link">1ã€main å…¨å±€å—</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#_2ã€events-å—" class="sidebar-link">2ã€events å—</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#_3ã€http-å—" class="sidebar-link">3ã€http å—</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#_4ã€upstream-å—" class="sidebar-link">4ã€upstream å—</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#_5ã€server-å—" class="sidebar-link">5ã€server å—</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#_6ã€locationå—" class="sidebar-link">6ã€locationå—</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#nginx-å…¨å±€å˜é‡" class="sidebar-link">nginx å…¨å±€å˜é‡</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#å®Œæ•´æ–‡ä»¶è¯¦è§£" class="sidebar-link">å®Œæ•´æ–‡ä»¶è¯¦è§£</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#ssl-é…ç½®" class="sidebar-link">SSl é…ç½®</a></li><li class="sidebar-sub-header"><a href="/pages/4f3ab6/#" class="sidebar-link"></a></li></ul></li><li><a href="/pages/ddf82b/" class="sidebar-link">Tomcat</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>æ•°æ®åº“</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>æœç´¢å¼•æ“</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>åˆ†å¸ƒå¼-å¾®æœåŠ¡</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>å®¹å™¨åŒ–</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰ç«¯</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- æ­£æ–¹å½¢ -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-283013c6><div class="articleInfo" data-v-283013c6><ul class="breadcrumbs" data-v-283013c6><li data-v-283013c6><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-283013c6></a></li> <li data-v-283013c6><a href="/framework" title="åº”ç”¨æ¡†æ¶-ç›®å½•é¡µ" data-v-283013c6>åº”ç”¨æ¡†æ¶</a></li> <li data-v-283013c6><a href="/framework/#åç«¯" title="åº”ç”¨æ¡†æ¶#åç«¯" data-v-283013c6>åç«¯</a></li> <li data-v-283013c6><a href="/framework/#æœåŠ¡å™¨è½¯ä»¶" title="åº”ç”¨æ¡†æ¶#æœåŠ¡å™¨è½¯ä»¶" data-v-283013c6>æœåŠ¡å™¨è½¯ä»¶</a></li></ul> <div class="info" data-v-283013c6><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-283013c6><a href="https://github.com/Jaredhi" target="_blank" title="ä½œè€…" class="beLink" data-v-283013c6>Jared H</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-283013c6><a href="javascript:;" data-v-283013c6>2020-09-21</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          Nginxé…ç½®è¯¦è§£
        </h1> <div class="page-slot page-slot-top"><!-- å›ºå®š100% * 90pxå¯æ˜¾ç¤ºï¼Œmax-height:90pxæœªè§æ˜¾ç¤º-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h2 id="é»˜è®¤é…ç½®æ–‡ä»¶"><a href="#é»˜è®¤é…ç½®æ–‡ä»¶" class="header-anchor">#</a> é»˜è®¤é…ç½®æ–‡ä»¶</h2> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹</summary> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment">#user  nobody;</span>
<span class="token keyword">worker_processes</span>  <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">#error_log  logs/error.log;</span>
<span class="token comment">#error_log  logs/error.log  notice;</span>
<span class="token comment">#error_log  logs/error.log  info;</span>

<span class="token comment">#pid        logs/nginx.pid;</span>


<span class="token keyword">events</span> <span class="token punctuation">{</span>
    <span class="token keyword">worker_connections</span>  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">http</span> <span class="token punctuation">{</span>
    <span class="token keyword">include</span>       mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>
    <span class="token keyword">default_type</span>  application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>

    <span class="token comment">#log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
    <span class="token comment">#                  '$status $body_bytes_sent &quot;$http_referer&quot; '</span>
    <span class="token comment">#                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';</span>

    <span class="token comment">#access_log  logs/access.log  main;</span>

    <span class="token keyword">sendfile</span>        on<span class="token punctuation">;</span>
    <span class="token comment">#tcp_nopush     on;</span>

    <span class="token comment">#keepalive_timeout  0;</span>
    <span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span><span class="token punctuation">;</span>

    <span class="token comment">#gzip  on;</span>
    <span class="token keyword">server</span> <span class="token punctuation">{</span>
        <span class="token keyword">listen</span>       <span class="token number">80</span><span class="token punctuation">;</span>
        <span class="token comment">#server_name  xxx.com;</span>

        <span class="token comment">#charset koi8-r;</span>

        <span class="token comment">#access_log  logs/host.access.log  main;</span>

        <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>Host <span class="token variable">$host</span><span class="token punctuation">;</span>
        <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span><span class="token keyword">Server</span> <span class="token variable">$host</span><span class="token punctuation">;</span>
        <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>

        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
            <span class="token keyword">root</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>
            <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
        <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>
            <span class="token keyword">root</span>   html<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># another virtual host using mix of IP-, name-, and port-based configuration</span>
    <span class="token comment">#</span>
    <span class="token comment">#server {</span>
    <span class="token comment">#    listen       8000;</span>
    <span class="token comment">#    listen       somename:8080;</span>
    <span class="token comment">#    server_name  somename  alias  another.alias;</span>

    <span class="token comment">#    location / {</span>
    <span class="token comment">#        root   html;</span>
    <span class="token comment">#        index  index.html index.htm;</span>
    <span class="token comment">#    }</span>
    <span class="token comment">#}</span>


    <span class="token comment"># HTTPS server</span>
    <span class="token comment">#</span>
    <span class="token comment">#server {</span>
    <span class="token comment">#    listen       443 ssl;</span>
    <span class="token comment">#    server_name  localhost;</span>

    <span class="token comment">#    ssl_certificate      cert.pem;</span>
    <span class="token comment">#    ssl_certificate_key  cert.key;</span>

    <span class="token comment">#    ssl_session_cache    shared:SSL:1m;</span>
    <span class="token comment">#    ssl_session_timeout  5m;</span>

    <span class="token comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span>
    <span class="token comment">#    ssl_prefer_server_ciphers  on;</span>

    <span class="token comment">#    location / {</span>
    <span class="token comment">#        root   html;</span>
    <span class="token comment">#        index  index.html index.htm;</span>
    <span class="token comment">#    }</span>
    <span class="token comment">#}</span>
    <span class="token keyword">include</span> servers<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br></div></div></details> <h2 id="é…ç½®æ–‡ä»¶ç»“æ„"><a href="#é…ç½®æ–‡ä»¶ç»“æ„" class="header-anchor">#</a> é…ç½®æ–‡ä»¶ç»“æ„</h2> <p><img src="https://www.jaredh.cn/12.%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AF%E4%BB%B6/img/02.Nginx%E9%85%8D%E7%BD%AE/image-20210417224533298.png" alt="image-20210417224533298"></p> <h3 id="_1ã€main-å…¨å±€å—"><a href="#_1ã€main-å…¨å±€å—" class="header-anchor">#</a> 1ã€main å…¨å±€å—</h3> <div class="custom-block tip"><p class="custom-block-title">ä½œç”¨</p> <p>é…ç½®å½±å“nginxå…¨å±€çš„æŒ‡ä»¤ã€‚ä¸€èˆ¬æœ‰è¿è¡ŒnginxæœåŠ¡å™¨çš„ç”¨æˆ·ç»„ï¼Œnginxè¿›ç¨‹pidå­˜æ”¾è·¯å¾„ï¼Œæ—¥å¿—å­˜æ”¾è·¯å¾„ï¼Œé…ç½®æ–‡ä»¶å¼•å…¥ï¼Œå…è®¸ç”Ÿæˆworker processæ•°ç­‰ã€‚</p></div> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">user</span>  www www<span class="token punctuation">;</span>
<span class="token keyword">worker_processes</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">worker_cpu_affinity</span> <span class="token number">0001</span> <span class="token number">0010</span> <span class="token number">0100</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token keyword">error_log</span>  <span class="token operator">/</span>data<span class="token operator">/</span>logs<span class="token operator">/</span>nginx_error<span class="token punctuation">.</span>log  crit<span class="token punctuation">;</span>
<span class="token keyword">pid</span>        <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>webserver<span class="token operator">/</span>nginx<span class="token operator">/</span>nginx<span class="token punctuation">.</span><span class="token keyword">pid</span><span class="token punctuation">;</span>
<span class="token keyword">worker_rlimit_nofile</span> <span class="token number">65535</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><strong>user :</strong>  æŒ‡å®šnginxè¿›ç¨‹ä½¿ç”¨ä»€ä¹ˆç”¨æˆ·å¯åŠ¨</li> <li><strong>worker_processes  :</strong>  æŒ‡å®šå¯åŠ¨å¤šå°‘è¿›ç¨‹æ¥å¤„ç†è¯·æ±‚ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®æˆCPUçš„æ ¸æ•°ï¼Œå¦‚æœå¼€å¯äº†sslå’Œgzipæ›´åº”è¯¥è®¾ç½®æˆä¸é€»è¾‘CPUæ•°é‡ä¸€æ ·ç”šè‡³ä¸º2å€ï¼Œå¯ä»¥å‡å°‘I/Oæ“ä½œã€‚ä½¿ç”¨<code>grep ^processor /proc/cpuinfo | wc -l</code>æŸ¥çœ‹CPUæ ¸æ•°ã€‚</li> <li><strong>worker_cpu_affinity :</strong>  åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œé€šè¿‡è®¾ç½®å°†CPUå’Œå…·ä½“çš„è¿›ç¨‹ç»‘å®šæ¥é™ä½ç”±äºå¤šæ ¸CPUåˆ‡æ¢é€ æˆçš„å¯„å­˜å™¨ç­‰ç°åœºé‡å»ºå¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚å¦‚worker_cpu_affinity 0001 0010 0100 1000; ï¼ˆå››æ ¸ï¼‰ã€‚</li> <li><strong>error_log :</strong>  ä¸»æ¨¡å—æŒ‡ä»¤ï¼Œç”¨æ¥å®šä¹‰å…¨å±€é”™è¯¯æ—¥å¿—æ–‡ä»¶ã€‚æ—¥å¿—è¾“å‡ºçº§åˆ«æœ‰<code>debugã€infoã€noticeã€warnã€errorã€crit</code>ï¼Œå…¶ä¸­ï¼Œdebugè¾“å‡ºæ—¥å¿—æœ€ä¸ºæœ€è¯¦ç»†ï¼Œè€Œcritè¾“å‡ºæ—¥å¿—æœ€å°‘ã€‚</li> <li><strong>pid  :</strong>  æŒ‡å®šè¿›ç¨‹pidæ–‡ä»¶çš„ä½ç½®ã€‚</li> <li><strong>worker_rlimit_nofile:</strong>  ç”¨äºæŒ‡å®šä¸€ä¸ª nginx è¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æè¿°ç¬¦æ•°ç›®ï¼Œè¿™é‡Œæ˜¯65535ï¼Œéœ€è¦ä½¿ç”¨å‘½ä»¤ â€œulimit -n 65535â€ æ¥è®¾ç½®ã€‚</li></ul> <h3 id="_2ã€events-å—"><a href="#_2ã€events-å—" class="header-anchor">#</a> 2ã€events å—</h3> <div class="custom-block tip"><p class="custom-block-title">ä½œç”¨</p> <p>é…ç½®å½±å“nginxæœåŠ¡å™¨æˆ–ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚æœ‰æ¯ä¸ªè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°ï¼Œé€‰å–å“ªç§äº‹ä»¶é©±åŠ¨æ¨¡å‹å¤„ç†è¿æ¥è¯·æ±‚ï¼Œæ˜¯å¦å…è®¸åŒæ—¶æ¥å—å¤šä¸ªç½‘è·¯è¿æ¥ï¼Œå¼€å¯å¤šä¸ªç½‘ç»œè¿æ¥åºåˆ—åŒ–ç­‰ã€‚</p></div> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">events</span><span class="token punctuation">{</span>
  <span class="token keyword">use</span> epoll<span class="token punctuation">;</span>
  <span class="token keyword">worker_connections</span>      <span class="token number">65536</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>useï¼š</strong> äº‹ä»¶æ¨¡å—æŒ‡ä»¤ï¼Œç”¨æ¥æŒ‡å®š Nginx çš„å·¥ä½œæ¨¡å¼ã€‚Nginx æ”¯æŒçš„å·¥ä½œæ¨¡å¼æœ‰<code>select|poll|kqueue|epoll|resig|/dev/poll|eventport</code>ã€‚å…¶ä¸­ select å’Œ poll éƒ½æ˜¯æ ‡å‡†çš„å·¥ä½œæ¨¡å¼ï¼Œkqueue å’Œ epoll æ˜¯é«˜æ•ˆçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒçš„æ˜¯ epoll ç”¨åœ¨ Linux å¹³å°ä¸Šï¼Œè€Œ kqueue ç”¨åœ¨ BSD ç³»ç»Ÿä¸­ã€‚å¯¹äº Linux ç³»ç»Ÿï¼Œepoll å·¥ä½œæ¨¡å¼æ˜¯é¦–é€‰ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸æ”¯æŒè¿™äº›é«˜æ•ˆæ¨¡å‹æ—¶æ‰ä½¿ç”¨ selectã€‚</li> <li><strong>worker_connectionsï¼š</strong>   æ¯ä¸€ä¸ªworkerè¿›ç¨‹èƒ½å¹¶å‘å¤„ç†ï¼ˆå‘èµ·ï¼‰çš„æœ€å¤§è¿æ¥æ•°ï¼ˆåŒ…å«ä¸å®¢æˆ·ç«¯æˆ–åç«¯è¢«ä»£ç†æœåŠ¡å™¨é—´ç­‰æ‰€æœ‰è¿æ¥æ•°ï¼‰ã€‚nginxä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œè®¡ç®—å…¬å¼ <code>æœ€å¤§è¿æ¥æ•° = worker_processes * worker_connections/4</code>ï¼Œæ‰€ä»¥è¿™é‡Œå®¢æˆ·ç«¯æœ€å¤§è¿æ¥æ•°æ˜¯65536ï¼Œè¿™ä¸ªå¯ä»¥å¢åˆ°åˆ°8192éƒ½æ²¡å…³ç³»ï¼Œçœ‹æƒ…å†µè€Œå®šï¼Œä½†ä¸èƒ½è¶…è¿‡åé¢çš„worker_rlimit_nofileã€‚å½“ nginx ä½œä¸º http æœåŠ¡å™¨æ—¶ï¼Œè®¡ç®—å…¬å¼é‡Œé¢æ˜¯é™¤ä»¥2ã€‚è¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°å— Linux ç³»ç»Ÿè¿›ç¨‹çš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°é™åˆ¶ï¼Œåœ¨æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤<code>ulimit -n 65536</code>å<code>worker_connections</code>çš„è®¾ç½®æ‰èƒ½ç”Ÿæ•ˆã€‚</li></ul> <h3 id="_3ã€http-å—"><a href="#_3ã€http-å—" class="header-anchor">#</a> 3ã€http å—</h3> <div class="custom-block tip"><p class="custom-block-title">ä½œç”¨</p> <p>å¯ä»¥åµŒå¥—å¤šä¸ªserverï¼Œé…ç½®ä»£ç†ï¼Œç¼“å­˜ï¼Œæ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®ã€‚å¦‚æ–‡ä»¶å¼•å…¥ï¼Œmime-typeå®šä¹‰ï¼Œæ—¥å¿—è‡ªå®šä¹‰ï¼Œæ˜¯å¦ä½¿ç”¨sendfileä¼ è¾“æ–‡ä»¶ï¼Œè¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•è¿æ¥è¯·æ±‚æ•°ç­‰ã€‚</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>http
<span class="token punctuation">{</span>
  include       mime.types<span class="token punctuation">;</span>
  default_type  application/octet-stream<span class="token punctuation">;</span>
  <span class="token comment">#charset  gb2312;</span>
  <span class="token comment">#access_log off;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>include</strong> ï¼š ä¸»æ¨¡å—æŒ‡ä»¤ï¼Œæ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨ï¼Œå®ç°å¯¹é…ç½®æ–‡ä»¶æ‰€åŒ…å«çš„æ–‡ä»¶çš„è®¾å®šï¼Œå¯ä»¥å‡å°‘ä¸»é…ç½®æ–‡ä»¶çš„å¤æ‚åº¦ã€‚</li> <li><strong>default_type</strong> ï¼š å±äºHTTPæ ¸å¿ƒæ¨¡å—æŒ‡ä»¤ï¼Œé»˜è®¤ä¸º<code>text/plain</code>ï¼Œè¿™é‡Œè®¾å®šä¸ºäºŒè¿›åˆ¶æµï¼Œä¹Ÿå°±æ˜¯å½“æ–‡ä»¶ç±»å‹æœªå®šä¹‰æ—¶ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä¾‹å¦‚åœ¨æ²¡æœ‰é…ç½®PHPç¯å¢ƒæ—¶ï¼ŒNginxæ˜¯ä¸äºˆè§£æçš„ï¼Œæ­¤æ—¶ï¼Œç”¨æµè§ˆå™¨è®¿é—®PHPæ–‡ä»¶å°±ä¼šå‡ºç°ä¸‹è½½çª—å£ã€‚</li> <li><strong>charset:</strong>   æŒ‡å®šå®¢æˆ·ç«¯ç¼–ç æ ¼å¼ã€‚</li> <li><strong>access_log:</strong>  æœåŠ¡æ—¥å¿—</li></ul> <h3 id="_4ã€upstream-å—"><a href="#_4ã€upstream-å—" class="header-anchor">#</a> 4ã€upstream å—</h3> <div class="custom-block tip"><p class="custom-block-title">ä½œç”¨</p> <p>å®šä¹‰è´Ÿè½½èŠ‚ç‚¹æ± </p></div> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">upstream</span> dynamic <span class="token punctuation">{</span>
    zone upstream_dynamic <span class="token number">64</span>k<span class="token punctuation">;</span>

    <span class="token keyword">server</span> backend1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com      weight<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">server</span> backend2<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token punctuation">:</span><span class="token number">8080</span> fail_timeout<span class="token operator">=</span><span class="token number">5</span>s slow_start<span class="token operator">=</span><span class="token number">30</span>s<span class="token punctuation">;</span>
    <span class="token keyword">server</span> <span class="token number">192.0</span><span class="token number">.2</span><span class="token number">.1</span>                 max_fails<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">server</span> backend3<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com      resolve<span class="token punctuation">;</span>

    <span class="token keyword">server</span> backup1<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token punctuation">:</span><span class="token number">8080</span>  backup<span class="token punctuation">;</span>
    <span class="token keyword">server</span> backup2<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token punctuation">:</span><span class="token number">8080</span>  backup<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>server IP è°ƒåº¦çŠ¶æ€</code></p> <ul><li><strong>down:</strong> è¡¨ç¤ºå½“å‰çš„serveræš‚æ—¶ä¸å‚ä¸è´Ÿè½½å‡è¡¡ã€‚</li> <li><strong>backup:</strong> é¢„ç•™çš„å¤‡ä»½æœåŠ¡å™¨ï¼Œå½“å…¶ä»–æ‰€æœ‰çš„ébackupæœåŠ¡å™¨å‡ºç°æ•…éšœæˆ–è€…å¿™çš„æ—¶å€™ï¼Œæ‰ä¼šè¯·æ±‚backupæœºå™¨ï¼Œå› ä¸ºè¿™å°é›†ç¾¤çš„å‹åŠ›æœ€å°</li> <li><strong>max_fails:</strong> å…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯1ï¼Œå½“è¶…è¿‡æœ€å¤§æ¬¡æ•°æ—¶ï¼Œè¿”å›proxy_next_upstreamæ¨¡å—å®šä¹‰çš„é”™è¯¯ã€‚0è¡¨ç¤ºç¦æ­¢å¤±è´¥å°è¯•ï¼Œä¼ä¸šåœºæ™¯ï¼š2-3.äº¬ä¸œ1æ¬¡ï¼Œè“æ±›10æ¬¡ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚å»é…ç½®ã€‚</li> <li><strong>fail_timeout :</strong>  åœ¨ç»å†äº†max_failsæ¬¡å¤±è´¥åï¼Œæš‚åœæœåŠ¡çš„æ—¶é—´ã€‚äº¬ä¸œæ˜¯3sï¼Œè“æ±›æ˜¯3sï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚é…ç½®ã€‚å¸¸è§„ä¸šåŠ¡2-3ç§’åˆç†ã€‚</li></ul> <blockquote><p>server å¦‚æœæ¥åŸŸåï¼Œéœ€è¦å†…ç½‘æœ‰DNSæœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨è´Ÿè½½å‡è¡¡å™¨çš„hostsæ–‡ä»¶åšåŸŸåè§£æã€‚serveråé¢è¿˜å¯ä»¥ç›´æ¥æ¥IPæˆ–IPåŠ ç«¯å£ã€‚</p></blockquote> <h4 id="nginx-é»˜è®¤æ”¯æŒå››ç§è°ƒåº¦ç®—æ³•"><a href="#nginx-é»˜è®¤æ”¯æŒå››ç§è°ƒåº¦ç®—æ³•" class="header-anchor">#</a> nginx é»˜è®¤æ”¯æŒå››ç§è°ƒåº¦ç®—æ³•</h4> <ul><li><strong>è½®è¯¢(é»˜è®¤)ï¼š</strong> æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨æ•…éšœï¼Œæ•…éšœç³»ç»Ÿè‡ªåŠ¨æ¸…é™¤ï¼Œä½¿ç”¨æˆ·è®¿é—®ä¸å—å½±å“ã€‚</li> <li><strong>è½®è¯¢æƒå€¼ï¼š</strong> weightå€¼è¶Šå¤§ï¼Œåˆ†é…åˆ°çš„è®¿é—®å‡ ç‡è¶Šé«˜ï¼Œä¸»è¦ç”¨äºåç«¯æ¯ä¸ªæœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µã€‚</li> <li><strong>ip_hashï¼š</strong>  æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®IPçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¥è‡ªåŒä¸€ä¸ªIPçš„å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œä¸»è¦è§£å†³åŠ¨æ€ç½‘ç«™sessionå…±äº«çš„é—®é¢˜ã€‚</li> <li><strong>least_connï¼š</strong>  æœ€å°‘é“¾æ¥æ•°ï¼Œé‚£ä¸ªæœºå™¨è¿æ¥æ•°å°‘å°±åˆ†å‘ã€‚</li></ul> <h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="header-anchor">#</a> å…¶ä»–</h4> <ul><li><p><strong>url_hashï¼š</strong> æŒ‰ç…§è®¿é—®çš„URLçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œæ˜¯æ¯ä¸ªURLå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜åç«¯ç¼“å­˜æœåŠ¡å™¨çš„æ•ˆç‡ã€‚éœ€è¦å®‰è£… nginx çš„ <code>hash</code> è½¯ä»¶åŒ…ã€‚</p></li> <li><p><strong>fairï¼š</strong> è¿™ä¸ªç®—æ³•å¯ä»¥ä¾æ®é¡µé¢å¤§å°å’ŒåŠ è½½æ—¶é—´é•¿çŸ­æ™ºèƒ½çš„è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œç›¸åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚éœ€è¦å®‰è£… <code>upstream_fail</code>æ¨¡å—ã€‚</p></li></ul> <h3 id="_5ã€server-å—"><a href="#_5ã€server-å—" class="header-anchor">#</a> 5ã€server å—</h3> <div class="custom-block tip"><p class="custom-block-title">ä½œç”¨</p> <p>é…ç½®è™šæ‹Ÿä¸»æœºçš„ç›¸å…³å‚æ•°ï¼Œä¸€ä¸ªhttpä¸­å¯ä»¥æœ‰å¤šä¸ªserverã€‚</p></div> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code>  <span class="token keyword">server</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">listen</span> <span class="token number">80</span> default<span class="token punctuation">;</span>
    <span class="token keyword">server_name</span> jaredh<span class="token punctuation">.</span>cn<span class="token punctuation">;</span>
    <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
    <span class="token keyword">root</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>
    <span class="token comment">#server_name_in_redirect off;</span>
    <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token punctuation">)</span>$
    <span class="token punctuation">{</span>
      <span class="token keyword">expires</span>      <span class="token number">30</span>d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$
    <span class="token punctuation">{</span>
      <span class="token keyword">expires</span>      <span class="token number">1</span>h<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><strong>listen:</strong>  ç›‘å¬ç«¯å£ï¼Œé»˜è®¤80ï¼Œå°äº1024çš„è¦ä»¥rootå¯åŠ¨ã€‚å¯ä»¥ä¸º <code>listen *:80</code>ã€<code>listen 127.0.0.1:80</code> ç­‰å½¢å¼ã€‚</li> <li><strong>server_name:</strong>  æœåŠ¡å™¨åï¼Œå¦‚ <code>localhost</code>ã€<code>www.example.com</code>ï¼Œå¯ä»¥é€šè¿‡æ­£åˆ™åŒ¹é…ã€‚</li> <li><strong>root:</strong>   å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½®ã€‚å¦‚æœ locationURL åŒ¹é…çš„æ˜¯å­ç›®å½•æˆ–æ–‡ä»¶ï¼Œroot æ²¡ä»€ä¹ˆä½œç”¨ï¼Œä¸€èˆ¬æ”¾åœ¨ server æŒ‡ä»¤é‡Œé¢æˆ–<code>/</code> ä¸‹ã€‚</li> <li><strong>index:</strong>  å®šä¹‰è·¯å¾„ä¸‹é»˜è®¤è®¿é—®çš„æ–‡ä»¶åï¼Œä¸€èˆ¬è·Ÿç€rootæ”¾ã€‚</li></ul> <h3 id="_6ã€locationå—"><a href="#_6ã€locationå—" class="header-anchor">#</a> 6ã€locationå—</h3> <div class="custom-block tip"><p class="custom-block-title">ä½œç”¨</p> <p>é…ç½®è¯·æ±‚çš„è·¯ç”±ï¼Œä»¥åŠå„ç§é¡µé¢çš„å¤„ç†æƒ…å†µã€‚</p></div> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
   <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>jaredh<span class="token punctuation">.</span>cn<span class="token punctuation">;</span>
   <span class="token keyword">proxy_set_header</span> host <span class="token variable">$host</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>proxy_set_headerï¼š</strong> å½“åç«¯WebæœåŠ¡å™¨ä¸Šä¹Ÿé…ç½®æœ‰å¤šä¸ªè™šæ‹Ÿä¸»æœºæ—¶ï¼Œéœ€è¦ç”¨è¯¥Headeræ¥åŒºåˆ†åå‘ä»£ç†å“ªä¸ªä¸»æœºåï¼Œ<code>proxy_set_header host $host;</code>ã€‚</li> <li><strong>proxy_set_header X-Forwarded-For ï¼š</strong> å¦‚æœåç«¯WebæœåŠ¡å™¨ä¸Šçš„ç¨‹åºéœ€è¦è·å–ç”¨æˆ·IPï¼Œä»è¯¥Headerå¤´è·å–ã€‚<code>proxy_set_header X-Forwarded-For $remote_addr;</code></li></ul> <h4 id="proxy-pass-ç›¸å…³çš„ä¼˜åŒ–å‚æ•°"><a href="#proxy-pass-ç›¸å…³çš„ä¼˜åŒ–å‚æ•°" class="header-anchor">#</a> proxy_pass ç›¸å…³çš„ä¼˜åŒ–å‚æ•°</h4> <ul><li><p><strong>client_max_body_size :</strong>   å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§çš„å•ä¸ªæ–‡ä»¶å­—èŠ‚æ•°ã€‚</p></li> <li><p><strong>client_body_buffer_size :</strong>  ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•° å¯ä»¥ç†è§£ä¸ºå…ˆä¿å­˜åˆ°æœ¬åœ°å†ä¼ ç»™ç”¨æˆ·ã€‚</p></li> <li><p><strong>proxy_connect_timeout:</strong>  è·Ÿåç«¯æœåŠ¡å™¨è¿æ¥çš„è¶…æ—¶æ—¶é—´_å‘èµ·æ¡æ‰‹ç­‰å€™å“åº”è¶…æ—¶æ—¶é—´ã€‚</p></li> <li><p><strong>proxy_read_timeout :</strong>  è¿æ¥æˆåŠŸå_ç­‰å€™åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´_å…¶å®å·²ç»è¿›å…¥åç«¯çš„æ’é˜Ÿä¹‹ä¸­ç­‰å€™å¤„ç†ã€‚</p></li> <li><p><strong>proxy_send_timeout:</strong> åç«¯æœåŠ¡å™¨å›ä¼ æ•°æ®æ—¶é—´,å°±æ˜¯åœ¨è§„å®šæ—¶é—´ä¹‹å†…åç«¯æœåŠ¡å™¨å¿…é¡»ä¼ å®Œæ‰€æœ‰çš„æ•°æ®ã€‚</p></li> <li><p><strong>proxy_buffer_size :</strong>  ä»£ç†è¯·æ±‚ç¼“å­˜åŒºï¼Œè¿™ä¸ªç¼“å­˜åŒºé—´ä¼šä¿å­˜ç”¨æˆ·çš„å¤´ä¿¡æ¯ä»¥ä¾›Nginxè¿›è¡Œè§„åˆ™å¤„ç†,ä¸€èˆ¬åªè¦è®¾ç½®èƒ½ä¿å­˜ä¸‹å¤´ä¿¡æ¯å³å¯ã€‚</p></li> <li><p><strong>proxy_buffers :</strong>  åŒä¸Š å‘Šè¯‰Nginxä¿å­˜å•ä¸ªé¡µé¢ä½¿ç”¨çš„ç©ºé—´å¤§å°ï¼Œå‡è®¾ç½‘é¡µå¤§å°å¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ã€‚</p></li> <li><p><strong>proxy_busy_buffers_size:</strong>  å¦‚æœç³»ç»Ÿå¾ˆå¿™çš„æ—¶å€™å¯ä»¥ç”³è¯·æ›´å¤§çš„ <code>proxy_buffers</code> å®˜æ–¹æ¨è(proxy_buffers*2)ã€‚</p></li> <li><p><strong>proxy_max_temp_file_size:</strong>  å½“ <code>proxy_buffers</code> æ”¾ä¸ä¸‹åç«¯æœåŠ¡å™¨çš„å“åº”å†…å®¹æ—¶ï¼Œä¼šå°†ä¸€éƒ¨åˆ†ä¿å­˜åˆ°ç¡¬ç›˜çš„ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªå€¼ç”¨æ¥è®¾ç½®æœ€å¤§ä¸´æ—¶æ–‡ä»¶å¤§å°ï¼Œ<strong>é»˜è®¤1024M</strong>ï¼Œå®ƒä¸ <code>proxy_cache</code> æ²¡æœ‰å…³ç³»ã€‚å¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä» upstream æœåŠ¡å™¨ä¼ å›ã€‚è®¾ç½®ä¸º0ç¦ç”¨ã€‚</p></li> <li><p><strong>proxy_temp_file_write_size:</strong>  proxy ç¼“å­˜ä¸´æ—¶æ–‡ä»¶çš„å¤§å° <code>proxy_temp_path</code>ï¼ˆå¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼‰æŒ‡å®šå†™åˆ°å“ªé‚£ä¸ªç›®å½•ã€‚</p></li></ul> <h4 id="è®¿é—®æ§åˆ¶-allow-deny"><a href="#è®¿é—®æ§åˆ¶-allow-deny" class="header-anchor">#</a> è®¿é—®æ§åˆ¶ allow/deny</h4> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">location</span> <span class="token operator">/</span>nginx<span class="token operator">-</span>status <span class="token punctuation">{</span>
  <span class="token keyword">allow</span> <span class="token number">192.168</span><span class="token number">.10</span><span class="token number">.100</span><span class="token punctuation">;</span>
  <span class="token keyword">allow</span> <span class="token number">192.168</span><span class="token number">.10</span><span class="token number">.99</span><span class="token punctuation">;</span>
  <span class="token keyword">deny</span> all<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="nginx-å…¨å±€å˜é‡"><a href="#nginx-å…¨å±€å˜é‡" class="header-anchor">#</a> nginx å…¨å±€å˜é‡</h3> <table><thead><tr><th>å˜é‡</th> <th>è§£é‡Š</th></tr></thead> <tbody><tr><td>$args</td> <td>è¿™ä¸ªå˜é‡ç­‰äºè¯·æ±‚è¡Œä¸­çš„å‚æ•°ï¼ŒåŒ$query_string</td></tr> <tr><td>$is_args</td> <td>å¦‚æœå·²ç»è®¾ç½®<code>$args</code>ï¼Œåˆ™è¯¥å˜é‡çš„å€¼ä¸º&quot;?&quot;ï¼Œå¦åˆ™ä¸º&quot;&quot;</td></tr> <tr><td>$content_length</td> <td>è¯·æ±‚å¤´ä¸­çš„Content-lengthå­—æ®µ</td></tr> <tr><td>$content_type</td> <td>è¯·æ±‚å¤´ä¸­çš„Content-Typeå­—æ®µ</td></tr> <tr><td>$uri</td> <td>ä¸å¸¦è¯·æ±‚å‚æ•°çš„å½“å‰URIï¼Œ$uriä¸åŒ…å«ä¸»æœºåï¼Œå¦‚<code>/foo/bar.html</code>å¯èƒ½å’Œæœ€åˆçš„å€¼æœ‰ä¸åŒï¼Œæ¯”å¦‚ç»è¿‡é‡å®šå‘ä¹‹ç±»çš„</td></tr> <tr><td>$document_uri</td> <td>ä¸$uriç›¸åŒ</td></tr> <tr><td>$document_root</td> <td>å½“å‰è¯·æ±‚åœ¨rootæŒ‡ä»¤ä¸­æŒ‡å®šçš„å€¼</td></tr> <tr><td>$host</td> <td>è¯·æ±‚ä¸»æœºå¤´å­—æ®µï¼Œå¦åˆ™ä¸ºæœåŠ¡å™¨åç§°</td></tr> <tr><td>$http_user_agent</td> <td>å®¢æˆ·ç«¯agentä¿¡æ¯</td></tr> <tr><td>$http_cookie</td> <td>å®¢æˆ·ç«¯cookieä¿¡æ¯</td></tr> <tr><td>$limit_rate</td> <td>è¿™ä¸ªå˜é‡å¯ä»¥é™åˆ¶è¿æ¥é€Ÿç‡</td></tr> <tr><td>$request_method</td> <td>å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œï¼Œé€šå¸¸ä¸ºGETæˆ–POST</td></tr> <tr><td>$remote_addr</td> <td>å®¢æˆ·ç«¯çš„IPåœ°å€</td></tr> <tr><td>$remote_port</td> <td>å®¢æˆ·ç«¯çš„ç«¯å£</td></tr> <tr><td>$remote_user</td> <td>å·²ç»ç»è¿‡Auth Basic ModuleéªŒè¯çš„ç”¨æˆ·å</td></tr> <tr><td>$request_body_file</td> <td>å®¢æˆ·ç«¯è¯·æ±‚ä¸»ä½“çš„ä¸´æ—¶æ–‡ä»¶å</td></tr> <tr><td>$request_uri</td> <td>è¯·æ±‚çš„URIï¼Œå¸¦å‚æ•°</td></tr> <tr><td>$request_filename</td> <td>å½“å‰è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸URIè¯·æ±‚ç”Ÿæˆ</td></tr> <tr><td>$scheme</td> <td>æ‰€ç”¨çš„åè®®ï¼Œæ¯”å¦‚httpæˆ–è€…æ˜¯httpsï¼Œæ¯”å¦‚<code>rewrite ^(.+)$ $scheme://example.com$1 redirect;</code></td></tr> <tr><td>$server_protocol</td> <td>è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯HTTP/1.0æˆ–HTTP/1.1</td></tr> <tr><td>$server_addr</td> <td>æœåŠ¡å™¨åœ°å€ï¼Œåœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼</td></tr> <tr><td>$server_name</td> <td>æœåŠ¡å™¨åç§°</td></tr> <tr><td>$server_port</td> <td>è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·</td></tr></tbody></table> <p>ä¾‹å­ï¼š</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code>è®¿é—®é“¾æ¥æ˜¯ï¼š<span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">88</span><span class="token operator">/</span>test1<span class="token operator">/</span>test2<span class="token operator">/</span>test<span class="token punctuation">.</span>html 
ç½‘ç«™è·¯å¾„æ˜¯ï¼š<span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html

<span class="token variable">$host</span>ï¼šlocalhost
<span class="token variable">$server_port</span>ï¼š<span class="token number">88</span>
<span class="token variable">$request_uri</span>ï¼š<span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">88</span><span class="token operator">/</span>test1<span class="token operator">/</span>test2<span class="token operator">/</span>test<span class="token punctuation">.</span>html
<span class="token variable">$document_uri</span>ï¼š<span class="token operator">/</span>test1<span class="token operator">/</span>test2<span class="token operator">/</span>test<span class="token punctuation">.</span>html
<span class="token variable">$document_root</span>ï¼š<span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html
<span class="token variable">$request_filename</span>ï¼š<span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>test1<span class="token operator">/</span>test2<span class="token operator">/</span>test<span class="token punctuation">.</span>html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="å®Œæ•´æ–‡ä»¶è¯¦è§£"><a href="#å®Œæ•´æ–‡ä»¶è¯¦è§£" class="header-anchor">#</a> å®Œæ•´æ–‡ä»¶è¯¦è§£</h2> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹</summary> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment">#å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„</span>
<span class="token keyword">user</span> www www<span class="token punctuation">;</span>
<span class="token comment">#nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚</span>
<span class="token keyword">worker_processes</span> <span class="token number">8</span><span class="token punctuation">;</span>
 
<span class="token comment">#å…¨å±€é”™è¯¯æ—¥å¿—å®šä¹‰ç±»å‹ï¼Œ[ debug | info | notice | warn | error | crit ]</span>
<span class="token keyword">error_log</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>error<span class="token punctuation">.</span>log info<span class="token punctuation">;</span>
<span class="token comment">#è¿›ç¨‹pidæ–‡ä»¶</span>
<span class="token keyword">pid</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>nginx<span class="token punctuation">.</span><span class="token keyword">pid</span><span class="token punctuation">;</span>
<span class="token comment">#æŒ‡å®šè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æè¿°ç¬¦ï¼šæ•°ç›®</span>
<span class="token comment">#å·¥ä½œæ¨¡å¼ä¸è¿æ¥æ•°ä¸Šé™</span>
<span class="token comment">#è¿™ä¸ªæŒ‡ä»¤æ˜¯æŒ‡å½“ä¸€ä¸ªnginxè¿›ç¨‹æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æè¿°ç¬¦æ•°ç›®ï¼Œç†è®ºå€¼åº”è¯¥æ˜¯æœ€å¤šæ‰“å¼€æ–‡ä»¶æ•°ï¼ˆulimit -nï¼‰ä¸nginxè¿›ç¨‹æ•°ç›¸é™¤ï¼Œä½†æ˜¯nginxåˆ†é…è¯·æ±‚å¹¶ä¸æ˜¯é‚£ä¹ˆå‡åŒ€ï¼Œæ‰€ä»¥æœ€å¥½ä¸ulimit -n çš„å€¼ä¿æŒä¸€è‡´ã€‚</span>
<span class="token comment">#ç°åœ¨åœ¨linux 2.6å†…æ ¸ä¸‹å¼€å¯æ–‡ä»¶æ‰“å¼€æ•°ä¸º65535ï¼Œworker_rlimit_nofileå°±ç›¸åº”åº”è¯¥å¡«å†™65535ã€‚</span>
<span class="token comment">#è¿™æ˜¯å› ä¸ºnginxè°ƒåº¦æ—¶åˆ†é…è¯·æ±‚åˆ°è¿›ç¨‹å¹¶ä¸æ˜¯é‚£ä¹ˆçš„å‡è¡¡ï¼Œæ‰€ä»¥å‡å¦‚å¡«å†™10240ï¼Œæ€»å¹¶å‘é‡è¾¾åˆ°3-4ä¸‡æ—¶å°±æœ‰è¿›ç¨‹å¯èƒ½è¶…è¿‡10240äº†ï¼Œè¿™æ—¶ä¼šè¿”å›502é”™è¯¯ã€‚</span>
<span class="token keyword">worker_rlimit_nofile</span> <span class="token number">65535</span><span class="token punctuation">;</span>
<span class="token keyword">events</span>
<span class="token punctuation">{</span>
    <span class="token comment">#å‚è€ƒäº‹ä»¶æ¨¡å‹ï¼Œuse [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epollæ¨¡å‹</span>
    <span class="token comment">#æ˜¯Linux 2.6ä»¥ä¸Šç‰ˆæœ¬å†…æ ¸ä¸­çš„é«˜æ€§èƒ½ç½‘ç»œI/Oæ¨¡å‹ï¼Œlinuxå»ºè®®epollï¼Œå¦‚æœè·‘åœ¨FreeBSDä¸Šé¢ï¼Œå°±ç”¨kqueueæ¨¡å‹ã€‚</span>
    <span class="token comment">#è¡¥å……è¯´æ˜ï¼š</span>
    <span class="token comment">#ä¸apacheç›¸ç±»ï¼Œnginxé’ˆå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œæœ‰ä¸åŒçš„äº‹ä»¶æ¨¡å‹</span>
    <span class="token comment">#Aï¼‰æ ‡å‡†äº‹ä»¶æ¨¡å‹</span>
    <span class="token comment">#Selectã€pollå±äºæ ‡å‡†äº‹ä»¶æ¨¡å‹ï¼Œå¦‚æœå½“å‰ç³»ç»Ÿä¸å­˜åœ¨æ›´æœ‰æ•ˆçš„æ–¹æ³•ï¼Œnginxä¼šé€‰æ‹©selectæˆ–poll</span>
    <span class="token comment">#Bï¼‰é«˜æ•ˆäº‹ä»¶æ¨¡å‹</span>
    <span class="token comment">#Kqueueï¼šä½¿ç”¨äºFreeBSD 4.1+, OpenBSD 2.9+, NetBSD 2.0 å’Œ MacOS X.ä½¿ç”¨åŒå¤„ç†å™¨çš„MacOS Xç³»ç»Ÿä½¿ç”¨kqueueå¯èƒ½ä¼šé€ æˆå†…æ ¸å´©æºƒã€‚</span>
    <span class="token comment">#Epollï¼šä½¿ç”¨äºLinuxå†…æ ¸2.6ç‰ˆæœ¬åŠä»¥åçš„ç³»ç»Ÿã€‚</span>
    <span class="token comment">#/dev/pollï¼šä½¿ç”¨äºSolaris 7 11/99+ï¼ŒHP/UX 11.22+ (eventport)ï¼ŒIRIX 6.5.15+ å’Œ Tru64 UNIX 5.1A+ã€‚</span>
    <span class="token comment">#Eventportï¼šä½¿ç”¨äºSolaris 10ã€‚ ä¸ºäº†é˜²æ­¢å‡ºç°å†…æ ¸å´©æºƒçš„é—®é¢˜ï¼Œ æœ‰å¿…è¦å®‰è£…å®‰å…¨è¡¥ä¸ã€‚</span>
    <span class="token keyword">use</span> epoll<span class="token punctuation">;</span>
    <span class="token comment">#å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°*è¿›ç¨‹æ•°ï¼‰</span>
    <span class="token comment">#æ ¹æ®ç¡¬ä»¶è°ƒæ•´ï¼Œå’Œå‰é¢å·¥ä½œè¿›ç¨‹é…åˆèµ·æ¥ç”¨ï¼Œå°½é‡å¤§ï¼Œä½†æ˜¯åˆ«æŠŠcpuè·‘åˆ°100%å°±è¡Œã€‚æ¯ä¸ªè¿›ç¨‹å…è®¸çš„æœ€å¤šè¿æ¥æ•°ï¼Œç†è®ºä¸Šæ¯å°nginxæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°ä¸ºã€‚</span>
    <span class="token keyword">worker_connections</span> <span class="token number">65535</span><span class="token punctuation">;</span>
    <span class="token comment">#keepaliveè¶…æ—¶æ—¶é—´ã€‚</span>
    <span class="token keyword">keepalive_timeout</span> <span class="token number">60</span><span class="token punctuation">;</span>
    <span class="token comment">#å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®ä½ çš„ç³»ç»Ÿåˆ†é¡µå¤§å°æ¥è®¾ç½®ï¼Œä¸€èˆ¬ä¸€ä¸ªè¯·æ±‚å¤´çš„å¤§å°ä¸ä¼šè¶…è¿‡1kï¼Œä¸è¿‡ç”±äºä¸€èˆ¬ç³»ç»Ÿåˆ†é¡µéƒ½è¦å¤§äº1kï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸ºåˆ†é¡µå¤§å°ã€‚</span>
    <span class="token comment">#åˆ†é¡µå¤§å°å¯ä»¥ç”¨å‘½ä»¤getconf PAGESIZE å–å¾—ã€‚</span>
    <span class="token comment">#[root@web001 ~]# getconf PAGESIZE</span>
    <span class="token comment">#4096</span>
    <span class="token comment">#ä½†ä¹Ÿæœ‰client_header_buffer_sizeè¶…è¿‡4kçš„æƒ…å†µï¼Œä½†æ˜¯client_header_buffer_sizeè¯¥å€¼å¿…é¡»è®¾ç½®ä¸ºâ€œç³»ç»Ÿåˆ†é¡µå¤§å°â€çš„æ•´å€æ•°ã€‚</span>
    <span class="token keyword">client_header_buffer_size</span> <span class="token number">4</span>k<span class="token punctuation">;</span>
    <span class="token comment">#è¿™ä¸ªå°†ä¸ºæ‰“å¼€æ–‡ä»¶æŒ‡å®šç¼“å­˜ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯ç”¨çš„ï¼ŒmaxæŒ‡å®šç¼“å­˜æ•°é‡ï¼Œå»ºè®®å’Œæ‰“å¼€æ–‡ä»¶æ•°ä¸€è‡´ï¼Œinactiveæ˜¯æŒ‡ç»è¿‡å¤šé•¿æ—¶é—´æ–‡ä»¶æ²¡è¢«è¯·æ±‚ååˆ é™¤ç¼“å­˜ã€‚</span>
    <span class="token keyword">open_file_cache</span> max<span class="token operator">=</span><span class="token number">65535</span> inactive<span class="token operator">=</span><span class="token number">60</span>s<span class="token punctuation">;</span>
    <span class="token comment">#è¿™ä¸ªæ˜¯æŒ‡å¤šé•¿æ—¶é—´æ£€æŸ¥ä¸€æ¬¡ç¼“å­˜çš„æœ‰æ•ˆä¿¡æ¯ã€‚</span>
    <span class="token comment">#è¯­æ³•:open_file_cache_valid time é»˜è®¤å€¼:open_file_cache_valid 60 ä½¿ç”¨å­—æ®µ:http, server, location è¿™ä¸ªæŒ‡ä»¤æŒ‡å®šäº†ä½•æ—¶éœ€è¦æ£€æŸ¥open_file_cacheä¸­ç¼“å­˜é¡¹ç›®çš„æœ‰æ•ˆä¿¡æ¯.</span>
    <span class="token keyword">open_file_cache_valid</span> <span class="token number">80</span>s<span class="token punctuation">;</span>
    <span class="token comment">#open_file_cacheæŒ‡ä»¤ä¸­çš„inactiveå‚æ•°æ—¶é—´å†…æ–‡ä»¶çš„æœ€å°‘ä½¿ç”¨æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸€ç›´æ˜¯åœ¨ç¼“å­˜ä¸­æ‰“å¼€çš„ï¼Œå¦‚ä¸Šä¾‹ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ–‡ä»¶åœ¨inactiveæ—¶é—´å†…ä¸€æ¬¡æ²¡è¢«ä½¿ç”¨ï¼Œå®ƒå°†è¢«ç§»é™¤ã€‚</span>
    <span class="token comment">#è¯­æ³•:open_file_cache_min_uses number é»˜è®¤å€¼:open_file_cache_min_uses 1 ä½¿ç”¨å­—æ®µ:http, server, location  è¿™ä¸ªæŒ‡ä»¤æŒ‡å®šäº†åœ¨open_file_cacheæŒ‡ä»¤æ— æ•ˆçš„å‚æ•°ä¸­ä¸€å®šçš„æ—¶é—´èŒƒå›´å†…å¯ä»¥ä½¿ç”¨çš„æœ€å°æ–‡ä»¶æ•°,å¦‚æœä½¿ç”¨æ›´å¤§çš„å€¼,æ–‡ä»¶æè¿°ç¬¦åœ¨cacheä¸­æ€»æ˜¯æ‰“å¼€çŠ¶æ€.</span>
    <span class="token keyword">open_file_cache_min_uses</span> <span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token comment">#è¯­æ³•:open_file_cache_errors on | off é»˜è®¤å€¼:open_file_cache_errors off ä½¿ç”¨å­—æ®µ:http, server, location è¿™ä¸ªæŒ‡ä»¤æŒ‡å®šæ˜¯å¦åœ¨æœç´¢ä¸€ä¸ªæ–‡ä»¶æ˜¯è®°å½•cacheé”™è¯¯.</span>
    <span class="token keyword">open_file_cache_errors</span> on<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
 
 
<span class="token comment">#è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ</span>
<span class="token keyword">http</span>
<span class="token punctuation">{</span>
    <span class="token comment">#æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨</span>
    <span class="token keyword">include</span> mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>
    <span class="token comment">#é»˜è®¤æ–‡ä»¶ç±»å‹</span>
    <span class="token keyword">default_type</span> application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>
    <span class="token comment">#é»˜è®¤ç¼–ç </span>
    <span class="token comment">#charset utf-8;</span>
    <span class="token comment">#æœåŠ¡å™¨åå­—çš„hashè¡¨å¤§å°</span>
    <span class="token comment">#ä¿å­˜æœåŠ¡å™¨åå­—çš„hashè¡¨æ˜¯ç”±æŒ‡ä»¤server_names_hash_max_size å’Œserver_names_hash_bucket_sizeæ‰€æ§åˆ¶çš„ã€‚å‚æ•°hash bucket sizeæ€»æ˜¯ç­‰äºhashè¡¨çš„å¤§å°ï¼Œå¹¶ä¸”æ˜¯ä¸€è·¯å¤„ç†å™¨ç¼“å­˜å¤§å°çš„å€æ•°ã€‚åœ¨å‡å°‘äº†åœ¨å†…å­˜ä¸­çš„å­˜å–æ¬¡æ•°åï¼Œä½¿åœ¨å¤„ç†å™¨ä¸­åŠ é€ŸæŸ¥æ‰¾hashè¡¨é”®å€¼æˆä¸ºå¯èƒ½ã€‚å¦‚æœhash bucket sizeç­‰äºä¸€è·¯å¤„ç†å™¨ç¼“å­˜çš„å¤§å°ï¼Œé‚£ä¹ˆåœ¨æŸ¥æ‰¾é”®çš„æ—¶å€™ï¼Œæœ€åçš„æƒ…å†µä¸‹åœ¨å†…å­˜ä¸­æŸ¥æ‰¾çš„æ¬¡æ•°ä¸º2ã€‚ç¬¬ä¸€æ¬¡æ˜¯ç¡®å®šå­˜å‚¨å•å…ƒçš„åœ°å€ï¼Œç¬¬äºŒæ¬¡æ˜¯åœ¨å­˜å‚¨å•å…ƒä¸­æŸ¥æ‰¾é”® å€¼ã€‚å› æ­¤ï¼Œå¦‚æœNginxç»™å‡ºéœ€è¦å¢å¤§hash max size æˆ– hash bucket sizeçš„æç¤ºï¼Œé‚£ä¹ˆé¦–è¦çš„æ˜¯å¢å¤§å‰ä¸€ä¸ªå‚æ•°çš„å¤§å°.</span>
    <span class="token keyword">server_names_hash_bucket_size</span> <span class="token number">128</span><span class="token punctuation">;</span>
    <span class="token comment">#å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®ä½ çš„ç³»ç»Ÿåˆ†é¡µå¤§å°æ¥è®¾ç½®ï¼Œä¸€èˆ¬ä¸€ä¸ªè¯·æ±‚çš„å¤´éƒ¨å¤§å°ä¸ä¼šè¶…è¿‡1kï¼Œä¸è¿‡ç”±äºä¸€èˆ¬ç³»ç»Ÿåˆ†é¡µéƒ½è¦å¤§äº1kï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸ºåˆ†é¡µå¤§å°ã€‚åˆ†é¡µå¤§å°å¯ä»¥ç”¨å‘½ä»¤getconf PAGESIZEå–å¾—ã€‚</span>
    <span class="token keyword">client_header_buffer_size</span> <span class="token number">32</span>k<span class="token punctuation">;</span>
    <span class="token comment">#å®¢æˆ·è¯·æ±‚å¤´ç¼“å†²å¤§å°ã€‚nginxé»˜è®¤ä¼šç”¨client_header_buffer_sizeè¿™ä¸ªbufferæ¥è¯»å–headerå€¼ï¼Œå¦‚æœheaderè¿‡å¤§ï¼Œå®ƒä¼šä½¿ç”¨large_client_header_buffersæ¥è¯»å–ã€‚</span>
    <span class="token keyword">large_client_header_buffers</span> <span class="token number">4</span> <span class="token number">64</span>k<span class="token punctuation">;</span>
    <span class="token comment">#è®¾å®šé€šè¿‡nginxä¸Šä¼ æ–‡ä»¶çš„å¤§å°</span>
    <span class="token keyword">client_max_body_size</span> <span class="token number">8</span>m<span class="token punctuation">;</span>
    <span class="token comment">#å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoffã€‚</span>
    <span class="token comment">#sendfileæŒ‡ä»¤æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œå¿…é¡»è®¾ä¸ºonã€‚å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œIOå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿuptimeã€‚</span>
    <span class="token keyword">sendfile</span> on<span class="token punctuation">;</span>
    <span class="token comment">#å¼€å¯ç›®å½•åˆ—è¡¨è®¿é—®ï¼Œåˆé€‚ä¸‹è½½æœåŠ¡å™¨ï¼Œé»˜è®¤å…³é—­ã€‚</span>
    <span class="token keyword">autoindex</span> on<span class="token punctuation">;</span>
    <span class="token comment">#æ­¤é€‰é¡¹å…è®¸æˆ–ç¦æ­¢ä½¿ç”¨sockeçš„TCP_CORKçš„é€‰é¡¹ï¼Œæ­¤é€‰é¡¹ä»…åœ¨ä½¿ç”¨sendfileçš„æ—¶å€™ä½¿ç”¨</span>
    <span class="token keyword">tcp_nopush</span> on<span class="token punctuation">;</span>
     
    <span class="token keyword">tcp_nodelay</span> on<span class="token punctuation">;</span>
    <span class="token comment">#é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</span>
    <span class="token keyword">keepalive_timeout</span> <span class="token number">120</span><span class="token punctuation">;</span>
    <span class="token comment">#FastCGIç›¸å…³å‚æ•°æ˜¯ä¸ºäº†æ”¹å–„ç½‘ç«™çš„æ€§èƒ½ï¼šå‡å°‘èµ„æºå ç”¨ï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚ä¸‹é¢å‚æ•°çœ‹å­—é¢æ„æ€éƒ½èƒ½ç†è§£ã€‚</span>
    <span class="token keyword">fastcgi_connect_timeout</span> <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token keyword">fastcgi_send_timeout</span> <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token keyword">fastcgi_read_timeout</span> <span class="token number">300</span><span class="token punctuation">;</span>
    <span class="token keyword">fastcgi_buffer_size</span> <span class="token number">64</span>k<span class="token punctuation">;</span>
    <span class="token keyword">fastcgi_buffers</span> <span class="token number">4</span> <span class="token number">64</span>k<span class="token punctuation">;</span>
    <span class="token keyword">fastcgi_busy_buffers_size</span> <span class="token number">128</span>k<span class="token punctuation">;</span>
    <span class="token keyword">fastcgi_temp_file_write_size</span> <span class="token number">128</span>k<span class="token punctuation">;</span>
    <span class="token comment">#gzipæ¨¡å—è®¾ç½®</span>
    <span class="token keyword">gzip</span> on<span class="token punctuation">;</span> <span class="token comment">#å¼€å¯gzipå‹ç¼©è¾“å‡º</span>
    <span class="token keyword">gzip_min_length</span> <span class="token number">1</span>k<span class="token punctuation">;</span>    <span class="token comment">#æœ€å°å‹ç¼©æ–‡ä»¶å¤§å°</span>
    <span class="token keyword">gzip_buffers</span> <span class="token number">4</span> <span class="token number">16</span>k<span class="token punctuation">;</span>    <span class="token comment">#å‹ç¼©ç¼“å†²åŒº</span>
    <span class="token keyword">gzip_http_version</span> <span class="token number">1.0</span><span class="token punctuation">;</span>    <span class="token comment">#å‹ç¼©ç‰ˆæœ¬ï¼ˆé»˜è®¤1.1ï¼Œå‰ç«¯å¦‚æœæ˜¯squid2.5è¯·ä½¿ç”¨1.0ï¼‰</span>
    <span class="token keyword">gzip_comp_level</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token comment">#å‹ç¼©ç­‰çº§</span>
    <span class="token keyword">gzip_types</span> text<span class="token operator">/</span>plain application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>css application<span class="token operator">/</span>xml<span class="token punctuation">;</span>    <span class="token comment">#å‹ç¼©ç±»å‹ï¼Œé»˜è®¤å°±å·²ç»åŒ…å«textmlï¼Œæ‰€ä»¥ä¸‹é¢å°±ä¸ç”¨å†å†™äº†ï¼Œå†™ä¸Šå»ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªwarnã€‚</span>
    <span class="token keyword">gzip_vary</span> on<span class="token punctuation">;</span>
    <span class="token comment">#å¼€å¯é™åˆ¶IPè¿æ¥æ•°çš„æ—¶å€™éœ€è¦ä½¿ç”¨</span>
    <span class="token comment">#limit_zone crawler $binary_remote_addr 10m;</span>
    <span class="token comment">#è´Ÿè½½å‡è¡¡é…ç½®</span>
    <span class="token keyword">upstream</span> piao<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com <span class="token punctuation">{</span>
     
        <span class="token comment">#upstreamçš„è´Ÿè½½å‡è¡¡ï¼Œweightæ˜¯æƒé‡ï¼Œå¯ä»¥æ ¹æ®æœºå™¨é…ç½®å®šä¹‰æƒé‡ã€‚weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ã€‚</span>
        <span class="token keyword">server</span> <span class="token number">192.168</span><span class="token number">.80</span><span class="token number">.121</span><span class="token punctuation">:</span><span class="token number">80</span> weight<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">server</span> <span class="token number">192.168</span><span class="token number">.80</span><span class="token number">.122</span><span class="token punctuation">:</span><span class="token number">80</span> weight<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">server</span> <span class="token number">192.168</span><span class="token number">.80</span><span class="token number">.123</span><span class="token punctuation">:</span><span class="token number">80</span> weight<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token comment">#nginxçš„upstreamç›®å‰æ”¯æŒ4ç§æ–¹å¼çš„åˆ†é…</span>
        <span class="token comment">#1ã€è½®è¯¢ï¼ˆé»˜è®¤ï¼‰</span>
        <span class="token comment">#æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚</span>
        <span class="token comment">#2ã€weight</span>
        <span class="token comment">#æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µã€‚</span>
        <span class="token comment">#ä¾‹å¦‚ï¼š</span>
        <span class="token comment">#upstream bakend {</span>
        <span class="token comment">#    server 192.168.0.14 weight=10;</span>
        <span class="token comment">#    server 192.168.0.15 weight=10;</span>
        <span class="token comment">#}</span>
        <span class="token comment">#2ã€ip_hash</span>
        <span class="token comment">#æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionçš„é—®é¢˜ã€‚</span>
        <span class="token comment">#ä¾‹å¦‚ï¼š</span>
        <span class="token comment">#upstream bakend {</span>
        <span class="token comment">#    ip_hash;</span>
        <span class="token comment">#    server 192.168.0.14:88;</span>
        <span class="token comment">#    server 192.168.0.15:80;</span>
        <span class="token comment">#}</span>
        <span class="token comment">#3ã€fairï¼ˆç¬¬ä¸‰æ–¹ï¼‰</span>
        <span class="token comment">#æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚</span>
        <span class="token comment">#upstream backend {</span>
        <span class="token comment">#    server server1;</span>
        <span class="token comment">#    server server2;</span>
        <span class="token comment">#    fair;</span>
        <span class="token comment">#}</span>
        <span class="token comment">#4ã€url_hashï¼ˆç¬¬ä¸‰æ–¹ï¼‰</span>
        <span class="token comment">#æŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚</span>
        <span class="token comment">#ä¾‹ï¼šåœ¨upstreamä¸­åŠ å…¥hashè¯­å¥ï¼Œserverè¯­å¥ä¸­ä¸èƒ½å†™å…¥weightç­‰å…¶ä»–çš„å‚æ•°ï¼Œhash_methodæ˜¯ä½¿ç”¨çš„hashç®—æ³•</span>
        <span class="token comment">#upstream backend {</span>
        <span class="token comment">#    server squid1:3128;</span>
        <span class="token comment">#    server squid2:3128;</span>
        <span class="token comment">#    hash $request_uri;</span>
        <span class="token comment">#    hash_method crc32;</span>
        <span class="token comment">#}</span>
        <span class="token comment">#tips:</span>
        <span class="token comment">#upstream bakend{#å®šä¹‰è´Ÿè½½å‡è¡¡è®¾å¤‡çš„IpåŠè®¾å¤‡çŠ¶æ€}{</span>
        <span class="token comment">#    ip_hash;</span>
        <span class="token comment">#    server 127.0.0.1:9090 down;</span>
        <span class="token comment">#    server 127.0.0.1:8080 weight=2;</span>
        <span class="token comment">#    server 127.0.0.1:6060;</span>
        <span class="token comment">#    server 127.0.0.1:7070 backup;</span>
        <span class="token comment">#}</span>
        <span class="token comment">#åœ¨éœ€è¦ä½¿ç”¨è´Ÿè½½å‡è¡¡çš„serverä¸­å¢åŠ  proxy_pass http://bakend/;</span>
        <span class="token comment">#æ¯ä¸ªè®¾å¤‡çš„çŠ¶æ€è®¾ç½®ä¸º:</span>
        <span class="token comment">#1.downè¡¨ç¤ºå•å‰çš„serveræš‚æ—¶ä¸å‚ä¸è´Ÿè½½</span>
        <span class="token comment">#2.weightä¸ºweightè¶Šå¤§ï¼Œè´Ÿè½½çš„æƒé‡å°±è¶Šå¤§ã€‚</span>
        <span class="token comment">#3.max_failsï¼šå…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°é»˜è®¤ä¸º1.å½“è¶…è¿‡æœ€å¤§æ¬¡æ•°æ—¶ï¼Œè¿”å›proxy_next_upstreamæ¨¡å—å®šä¹‰çš„é”™è¯¯</span>
        <span class="token comment">#4.fail_timeout:max_failsæ¬¡å¤±è´¥åï¼Œæš‚åœçš„æ—¶é—´ã€‚</span>
        <span class="token comment">#5.backupï¼š å…¶å®ƒæ‰€æœ‰çš„ébackupæœºå™¨downæˆ–è€…å¿™çš„æ—¶å€™ï¼Œè¯·æ±‚backupæœºå™¨ã€‚æ‰€ä»¥è¿™å°æœºå™¨å‹åŠ›ä¼šæœ€è½»ã€‚</span>
        <span class="token comment">#nginxæ”¯æŒåŒæ—¶è®¾ç½®å¤šç»„çš„è´Ÿè½½å‡è¡¡ï¼Œç”¨æ¥ç»™ä¸ç”¨çš„serveræ¥ä½¿ç”¨ã€‚</span>
        <span class="token comment">#client_body_in_file_onlyè®¾ç½®ä¸ºOn å¯ä»¥è®²client postè¿‡æ¥çš„æ•°æ®è®°å½•åˆ°æ–‡ä»¶ä¸­ç”¨æ¥åšdebug</span>
        <span class="token comment">#client_body_temp_pathè®¾ç½®è®°å½•æ–‡ä»¶çš„ç›®å½• å¯ä»¥è®¾ç½®æœ€å¤š3å±‚ç›®å½•</span>
        <span class="token comment">#locationå¯¹URLè¿›è¡ŒåŒ¹é….å¯ä»¥è¿›è¡Œé‡å®šå‘æˆ–è€…è¿›è¡Œæ–°çš„ä»£ç† è´Ÿè½½å‡è¡¡</span>
    <span class="token punctuation">}</span>
     
     
     
    <span class="token comment">#è™šæ‹Ÿä¸»æœºçš„é…ç½®</span>
    <span class="token keyword">server</span>
    <span class="token punctuation">{</span>
        <span class="token comment">#ç›‘å¬ç«¯å£</span>
        <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>
        <span class="token comment">#åŸŸåå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€</span>
        <span class="token keyword">server_name</span> www<span class="token punctuation">.</span>jd<span class="token punctuation">.</span>com jd<span class="token punctuation">.</span>com<span class="token punctuation">;</span>
        <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm <span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>
        <span class="token keyword">root</span> <span class="token operator">/</span>data<span class="token operator">/</span>www<span class="token operator">/</span>jd<span class="token punctuation">;</span>
        <span class="token comment">#å¯¹******è¿›è¡Œè´Ÿè½½å‡è¡¡</span>
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token punctuation">(</span>php<span class="token operator">|</span>php5<span class="token punctuation">)</span><span class="token operator">?</span>$
        <span class="token punctuation">{</span>
            <span class="token keyword">fastcgi_pass</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">9000</span><span class="token punctuation">;</span>
            <span class="token keyword">fastcgi_index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>
            <span class="token keyword">include</span> fastcgi<span class="token punctuation">.</span>conf<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        <span class="token comment">#å›¾ç‰‡ç¼“å­˜æ—¶é—´è®¾ç½®</span>
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token punctuation">)</span>$
        <span class="token punctuation">{</span>
            <span class="token keyword">expires</span> <span class="token number">10</span>d<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        <span class="token comment">#JSå’ŒCSSç¼“å­˜æ—¶é—´è®¾ç½®</span>
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$
        <span class="token punctuation">{</span>
            <span class="token keyword">expires</span> <span class="token number">1</span>h<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        <span class="token comment">#æ—¥å¿—æ ¼å¼è®¾å®š</span>
        <span class="token comment">#$remote_addrä¸$http_x_forwarded_forç”¨ä»¥è®°å½•å®¢æˆ·ç«¯çš„ipåœ°å€ï¼›</span>
        <span class="token comment">#$remote_userï¼šç”¨æ¥è®°å½•å®¢æˆ·ç«¯ç”¨æˆ·åç§°ï¼›</span>
        <span class="token comment">#$time_localï¼š ç”¨æ¥è®°å½•è®¿é—®æ—¶é—´ä¸æ—¶åŒºï¼›</span>
        <span class="token comment">#$requestï¼š ç”¨æ¥è®°å½•è¯·æ±‚çš„urlä¸httpåè®®ï¼›</span>
        <span class="token comment">#$statusï¼š ç”¨æ¥è®°å½•è¯·æ±‚çŠ¶æ€ï¼›æˆåŠŸæ˜¯200ï¼Œ</span>
        <span class="token comment">#$body_bytes_sent ï¼šè®°å½•å‘é€ç»™å®¢æˆ·ç«¯æ–‡ä»¶ä¸»ä½“å†…å®¹å¤§å°ï¼›</span>
        <span class="token comment">#$http_refererï¼šç”¨æ¥è®°å½•ä»é‚£ä¸ªé¡µé¢é“¾æ¥è®¿é—®è¿‡æ¥çš„ï¼›</span>
        <span class="token comment">#$http_user_agentï¼šè®°å½•å®¢æˆ·æµè§ˆå™¨çš„ç›¸å…³ä¿¡æ¯ï¼›</span>
        <span class="token comment">#é€šå¸¸webæœåŠ¡å™¨æ”¾åœ¨åå‘ä»£ç†çš„åé¢ï¼Œè¿™æ ·å°±ä¸èƒ½è·å–åˆ°å®¢æˆ·çš„IPåœ°å€äº†ï¼Œé€šè¿‡$remote_addæ‹¿åˆ°çš„IPåœ°å€æ˜¯åå‘ä»£ç†æœåŠ¡å™¨çš„iPåœ°å€ã€‚åå‘ä»£ç†æœåŠ¡å™¨åœ¨è½¬å‘è¯·æ±‚çš„httpå¤´ä¿¡æ¯ä¸­ï¼Œå¯ä»¥å¢åŠ x_forwarded_forä¿¡æ¯ï¼Œç”¨ä»¥è®°å½•åŸæœ‰å®¢æˆ·ç«¯çš„IPåœ°å€å’ŒåŸæ¥å®¢æˆ·ç«¯çš„è¯·æ±‚çš„æœåŠ¡å™¨åœ°å€ã€‚</span>
        <span class="token keyword">log_format</span> access <span class="token string">'$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
        <span class="token string">'$status $body_bytes_sent &quot;$http_referer&quot; '</span>
        <span class="token string">'&quot;$http_user_agent&quot; $http_x_forwarded_for'</span><span class="token punctuation">;</span>
         
        <span class="token comment">#å®šä¹‰æœ¬è™šæ‹Ÿä¸»æœºçš„è®¿é—®æ—¥å¿—</span>
        <span class="token keyword">access_log</span>  <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>
        <span class="token keyword">access_log</span>  <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span><span class="token number">404.</span>log  log404<span class="token punctuation">;</span>
         
        <span class="token comment">#å¯¹ &quot;/&quot; å¯ç”¨åå‘ä»£ç†</span>
        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
            <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">88</span><span class="token punctuation">;</span>
            <span class="token keyword">proxy_redirect</span> off<span class="token punctuation">;</span>
            <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
             
            <span class="token comment">#åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP</span>
            <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
             
            <span class="token comment">#ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®ï¼Œå¯é€‰ã€‚</span>
            <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>
            <span class="token comment">#å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°</span>
            <span class="token keyword">client_max_body_size</span> <span class="token number">10</span>m<span class="token punctuation">;</span>
            <span class="token comment">#ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œ</span>
            <span class="token comment">#å¦‚æœæŠŠå®ƒè®¾ç½®ä¸ºæ¯”è¾ƒå¤§çš„æ•°å€¼ï¼Œä¾‹å¦‚256kï¼Œé‚£ä¹ˆï¼Œæ— è®ºä½¿ç”¨firefoxè¿˜æ˜¯IEæµè§ˆå™¨ï¼Œæ¥æäº¤ä»»æ„å°äº256kçš„å›¾ç‰‡ï¼Œéƒ½å¾ˆæ­£å¸¸ã€‚å¦‚æœæ³¨é‡Šè¯¥æŒ‡ä»¤ï¼Œä½¿ç”¨é»˜è®¤çš„client_body_buffer_sizeè®¾ç½®ï¼Œä¹Ÿå°±æ˜¯æ“ä½œç³»ç»Ÿé¡µé¢å¤§å°çš„ä¸¤å€ï¼Œ8kæˆ–è€…16kï¼Œé—®é¢˜å°±å‡ºç°äº†ã€‚</span>
            <span class="token comment">#æ— è®ºä½¿ç”¨firefox4.0è¿˜æ˜¯IE8.0ï¼Œæäº¤ä¸€ä¸ªæ¯”è¾ƒå¤§ï¼Œ200kå·¦å³çš„å›¾ç‰‡ï¼Œéƒ½è¿”å›500 Internal Server Erroré”™è¯¯</span>
            <span class="token keyword">client_body_buffer_size</span> <span class="token number">128</span>k<span class="token punctuation">;</span>
            <span class="token comment">#è¡¨ç¤ºä½¿nginxé˜»æ­¢HTTPåº”ç­”ä»£ç ä¸º400æˆ–è€…æ›´é«˜çš„åº”ç­”ã€‚</span>
            <span class="token keyword">proxy_intercept_errors</span> on<span class="token punctuation">;</span>
            <span class="token comment">#åç«¯æœåŠ¡å™¨è¿æ¥çš„è¶…æ—¶æ—¶é—´_å‘èµ·æ¡æ‰‹ç­‰å€™å“åº”è¶…æ—¶æ—¶é—´</span>
            <span class="token comment">#nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)</span>
            <span class="token keyword">proxy_connect_timeout</span> <span class="token number">90</span><span class="token punctuation">;</span>
            <span class="token comment">#åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)</span>
            <span class="token comment">#åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´_å°±æ˜¯åœ¨è§„å®šæ—¶é—´ä¹‹å†…åç«¯æœåŠ¡å™¨å¿…é¡»ä¼ å®Œæ‰€æœ‰çš„æ•°æ®</span>
            <span class="token keyword">proxy_send_timeout</span> <span class="token number">90</span><span class="token punctuation">;</span>
            <span class="token comment">#è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)</span>
            <span class="token comment">#è¿æ¥æˆåŠŸå_ç­‰å€™åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´_å…¶å®å·²ç»è¿›å…¥åç«¯çš„æ’é˜Ÿä¹‹ä¸­ç­‰å€™å¤„ç†ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯åç«¯æœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼‰</span>
            <span class="token keyword">proxy_read_timeout</span> <span class="token number">90</span><span class="token punctuation">;</span>
            <span class="token comment">#è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°</span>
            <span class="token comment">#è®¾ç½®ä»è¢«ä»£ç†æœåŠ¡å™¨è¯»å–çš„ç¬¬ä¸€éƒ¨åˆ†åº”ç­”çš„ç¼“å†²åŒºå¤§å°ï¼Œé€šå¸¸æƒ…å†µä¸‹è¿™éƒ¨åˆ†åº”ç­”ä¸­åŒ…å«ä¸€ä¸ªå°çš„åº”ç­”å¤´ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿™ä¸ªå€¼çš„å¤§å°ä¸ºæŒ‡ä»¤proxy_buffersä¸­æŒ‡å®šçš„ä¸€ä¸ªç¼“å†²åŒºçš„å¤§å°ï¼Œä¸è¿‡å¯ä»¥å°†å…¶è®¾ç½®ä¸ºæ›´å°</span>
            <span class="token keyword">proxy_buffer_size</span> <span class="token number">4</span>k<span class="token punctuation">;</span>
            <span class="token comment">#proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è®¾ç½®</span>
            <span class="token comment">#è®¾ç½®ç”¨äºè¯»å–åº”ç­”ï¼ˆæ¥è‡ªè¢«ä»£ç†æœåŠ¡å™¨ï¼‰çš„ç¼“å†²åŒºæ•°ç›®å’Œå¤§å°ï¼Œé»˜è®¤æƒ…å†µä¹Ÿä¸ºåˆ†é¡µå¤§å°ï¼Œæ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒå¯èƒ½æ˜¯4kæˆ–è€…8k</span>
            <span class="token keyword">proxy_buffers</span> <span class="token number">4</span> <span class="token number">32</span>k<span class="token punctuation">;</span>
            <span class="token comment">#é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰</span>
            <span class="token keyword">proxy_busy_buffers_size</span> <span class="token number">64</span>k<span class="token punctuation">;</span>
            <span class="token comment">#è®¾ç½®åœ¨å†™å…¥proxy_temp_pathæ—¶æ•°æ®çš„å¤§å°ï¼Œé¢„é˜²ä¸€ä¸ªå·¥ä½œè¿›ç¨‹åœ¨ä¼ é€’æ–‡ä»¶æ—¶é˜»å¡å¤ªé•¿</span>
            <span class="token comment">#è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ </span>
            <span class="token keyword">proxy_temp_file_write_size</span> <span class="token number">64</span>k<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
         
        <span class="token comment">#è®¾å®šæŸ¥çœ‹NginxçŠ¶æ€çš„åœ°å€</span>
        <span class="token keyword">location</span> <span class="token operator">/</span>NginxStatus <span class="token punctuation">{</span>
            <span class="token keyword">stub_status</span> on<span class="token punctuation">;</span>
            <span class="token keyword">access_log</span> on<span class="token punctuation">;</span>
            <span class="token keyword">auth_basic</span> <span class="token string">&quot;NginxStatus&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">auth_basic_user_file</span> confpasswd<span class="token punctuation">;</span>
            <span class="token comment">#htpasswdæ–‡ä»¶çš„å†…å®¹å¯ä»¥ç”¨apacheæä¾›çš„htpasswdå·¥å…·æ¥äº§ç”Ÿã€‚</span>
        <span class="token punctuation">}</span>
         
        <span class="token comment">#æœ¬åœ°åŠ¨é™åˆ†ç¦»åå‘ä»£ç†é…ç½®</span>
        <span class="token comment">#æ‰€æœ‰jspçš„é¡µé¢å‡äº¤ç”±tomcatæˆ–resinå¤„ç†</span>
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token punctuation">(</span>jsp<span class="token operator">|</span>jspx<span class="token operator">|</span>do<span class="token punctuation">)</span><span class="token operator">?</span>$ <span class="token punctuation">{</span>
            <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>
            <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
            <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
         
        <span class="token comment">#æ‰€æœ‰é™æ€æ–‡ä»¶ç”±nginxç›´æ¥è¯»å–ä¸ç»è¿‡tomcatæˆ–resin</span>
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token punctuation">(</span>htm<span class="token operator">|</span>html<span class="token operator">|</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token operator">|</span>ioc<span class="token operator">|</span>rar<span class="token operator">|</span>zip<span class="token operator">|</span>txt<span class="token operator">|</span><span class="token keyword">flv</span><span class="token operator">|</span>mid<span class="token operator">|</span>doc<span class="token operator">|</span>ppt<span class="token operator">|</span>
        pdf<span class="token operator">|</span>xls<span class="token operator">|</span>mp3<span class="token operator">|</span>wma<span class="token punctuation">)</span>$
        <span class="token punctuation">{</span>
            <span class="token keyword">expires</span> <span class="token number">15</span>d<span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
         
        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$
        <span class="token punctuation">{</span>
            <span class="token keyword">expires</span> <span class="token number">1</span>h<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br></div></div></details> <h2 id="ssl-é…ç½®"><a href="#ssl-é…ç½®" class="header-anchor">#</a> SSl é…ç½®</h2> <p>â›³ï¸ <a href="https://help.aliyun.com/document_detail/98728.html?spm=a2c4g.11186623.6.627.36b8119e4FCahf" target="_blank" rel="noopener noreferrer">é˜¿é‡Œäº‘æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹</summary> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment">#user  nobody;</span>
<span class="token keyword">worker_processes</span>  <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">events</span> <span class="token punctuation">{</span>
    <span class="token keyword">worker_connections</span>  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">http</span> <span class="token punctuation">{</span>
    <span class="token keyword">include</span>       mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>
    <span class="token keyword">default_type</span>  application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>

    <span class="token keyword">sendfile</span>        on<span class="token punctuation">;</span>
    <span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span><span class="token punctuation">;</span>

    <span class="token comment">#ä»¥ä¸‹å±æ€§ä¸­ï¼Œä»¥sslå¼€å¤´çš„å±æ€§è¡¨ç¤ºä¸è¯ä¹¦é…ç½®æœ‰å…³ã€‚</span>
    <span class="token keyword">server</span> <span class="token punctuation">{</span>
        <span class="token keyword">listen</span> <span class="token number">443</span> <span class="token keyword">ssl</span><span class="token punctuation">;</span>
        <span class="token comment">#é…ç½®HTTPSçš„é»˜è®¤è®¿é—®ç«¯å£ä¸º443ã€‚</span>
        <span class="token comment">#å¦‚æœæœªåœ¨æ­¤å¤„é…ç½®HTTPSçš„é»˜è®¤è®¿é—®ç«¯å£ï¼Œå¯èƒ½ä¼šé€ æˆNginxæ— æ³•å¯åŠ¨ã€‚</span>
        <span class="token comment">#å¦‚æœæ‚¨ä½¿ç”¨Nginx 1.15.0åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨listen 443 sslä»£æ›¿listen 443å’Œssl onã€‚</span>
        <span class="token keyword">server_name</span> yourdomain<span class="token punctuation">.</span>com<span class="token punctuation">;</span> <span class="token comment">#éœ€è¦å°†yourdomain.comæ›¿æ¢æˆè¯ä¹¦ç»‘å®šçš„åŸŸåã€‚</span>
        <span class="token keyword">root</span> html<span class="token punctuation">;</span>
        <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token keyword">ssl_certificate</span> cert<span class="token operator">/</span>cert<span class="token operator">-</span>file<span class="token operator">-</span>name<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>  <span class="token comment">#éœ€è¦å°†cert-file-name.pemæ›¿æ¢æˆå·²ä¸Šä¼ çš„è¯ä¹¦æ–‡ä»¶çš„åç§°ã€‚</span>
        <span class="token keyword">ssl_certificate_key</span> cert<span class="token operator">/</span>cert<span class="token operator">-</span>file<span class="token operator">-</span>name<span class="token punctuation">.</span>key<span class="token punctuation">;</span> <span class="token comment">#éœ€è¦å°†cert-file-name.keyæ›¿æ¢æˆå·²ä¸Šä¼ çš„è¯ä¹¦å¯†é’¥æ–‡ä»¶çš„åç§°ã€‚</span>
        <span class="token keyword">ssl_session_timeout</span> <span class="token number">5</span>m<span class="token punctuation">;</span>
        <span class="token keyword">ssl_ciphers</span> ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES128<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA256<span class="token punctuation">:</span>ECDHE<span class="token punctuation">:</span>ECDH<span class="token punctuation">:</span>AES<span class="token punctuation">:</span>HIGH<span class="token punctuation">:</span><span class="token operator">!</span>NULL<span class="token punctuation">:</span><span class="token operator">!</span>aNULL<span class="token punctuation">:</span><span class="token operator">!</span>MD5<span class="token punctuation">:</span><span class="token operator">!</span>ADH<span class="token punctuation">:</span><span class="token operator">!</span>RC4<span class="token punctuation">;</span>
        <span class="token comment">#è¡¨ç¤ºä½¿ç”¨çš„åŠ å¯†å¥—ä»¶çš„ç±»å‹ã€‚</span>
        <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token punctuation">.</span><span class="token number">1</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">#è¡¨ç¤ºä½¿ç”¨çš„TLSåè®®çš„ç±»å‹ã€‚</span>
        <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>
        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
            <span class="token keyword">root</span> html<span class="token punctuation">;</span>  <span class="token comment">#ç«™ç‚¹ç›®å½•ã€‚</span>
            <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">server</span> <span class="token punctuation">{</span>
        <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>
        <span class="token keyword">server_name</span> yourdomain<span class="token punctuation">.</span>com<span class="token punctuation">;</span> <span class="token comment">#éœ€è¦å°†yourdomain.comæ›¿æ¢æˆè¯ä¹¦ç»‘å®šçš„åŸŸåã€‚</span>
        <span class="token keyword">rewrite</span> <span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span>$ <span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$host</span>$<span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">#å°†æ‰€æœ‰HTTPè¯·æ±‚é€šè¿‡rewriteæŒ‡ä»¤é‡å®šå‘åˆ°HTTPSã€‚</span>
        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
            <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">include</span> servers<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div></details> <h2 id=""><a href="#" class="header-anchor">#</a></h2> <p>ğŸ–  <strong>å‚è€ƒ</strong></p> <ul><li><p><a href="http://nginx.org/en/docs/" target="_blank" rel="noopener noreferrer">Nginx å®˜æ–¹æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://www.cnblogs.com/biglittleant/p/8979966.html" target="_blank" rel="noopener noreferrer">æ­»ç£• nginx ç³»åˆ—<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://www.runoob.com/w3cnote/nginx-setup-intro.html" target="_blank" rel="noopener noreferrer">Nginx é…ç½®è¯¦è§£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></div></div> <div class="page-slot page-slot-bottom"><!-- æ¨ªå‘è‡ªé€‚åº” -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2021/04/18, 00:50:27</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/31cc55/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Nginx</div></a> <a href="/pages/ddf82b/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Tomcat</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/31cc55/" class="prev">Nginx</a></span> <span class="next"><a href="/pages/ddf82b/">Tomcat</a>â†’
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:hwj2586@163.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Jaredhi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/Jared-h" title="GitHub" target="_blank" class="iconfont icon-gitee"></a><a href="https://t.kugou.com/2npMP0dxWV2" title="å¬éŸ³ä¹" target="_blank" class="iconfont icon-erji"></a></div> 
    Theme by
    <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a>
    Copyright Â© 2020-2021
    <span>Jared H <br> <a href="https://www.beian.miit.gov.cn" target="_blank">ç²¤ICPå¤‡20046800å·</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">è·Ÿéšç³»ç»Ÿ</li><li class="iconfont icon-rijianmoshi">æµ…è‰²æ¨¡å¼</li><li class="iconfont icon-yejianmoshi">æ·±è‰²æ¨¡å¼</li><li class="iconfont icon-yuedu">é˜…è¯»æ¨¡å¼</li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">Ã—</i> <div><!-- å›ºå®š160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.dce23f32.js" defer></script><script src="/assets/js/2.0a476569.js" defer></script><script src="/assets/js/3.03310ead.js" defer></script><script src="/assets/js/59.681ea709.js" defer></script>
  </body>
</html>