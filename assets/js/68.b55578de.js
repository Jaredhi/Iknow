(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{489:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("h3",{attrs:{id:"关于容器挂载路径"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于容器挂载路径"}},[s._v("#")]),s._v(" 关于容器挂载路径")]),s._v(" "),a("p",[s._v("我一般存放到 /opt/docker/ 下面。（有 root 用户情况下）")]),s._v(" "),a("p",[s._v("对应挂载的文件目录应该提前创建好。例如：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/nginx/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("conf,conf.d,html,logs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"关于容器内部时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于容器内部时间"}},[s._v("#")]),s._v(" 关于容器内部时间")]),s._v(" "),a("blockquote",[a("p",[s._v("docker容器内时间与服务器时间差距8小时，因为原生docker是0时区，但我们服务器采用亚洲上海东八区。")])]),s._v(" "),a("h4",{attrs:{id:"未启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#未启动容器"}},[s._v("#")]),s._v(" 未启动容器")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("将本地的 "),a("code",[s._v("localtime")]),s._v("和"),a("code",[s._v("timezone")]),s._v(" ,挂载到容器中。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-v /etc/localtime:/etc/localtime")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("-v /etc/timezone:/etc/timezone")]),s._v(" （不一定需要）")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以下是 timezone 文件内容")]),s._v("\nAsia/Shanghai\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"已经启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#已经启动容器"}},[s._v("#")]),s._v(" 已经启动容器")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("首先进入容器 "),a("code",[s._v("docker exec -it /bin/sh")]),s._v(" 查询时间 "),a("code",[s._v("date -R")])])]),s._v(" "),a("li",[a("p",[s._v("创建文件夹"),a("code",[s._v("mkdir -p /usr/share/zoneinfo/Asia")])])]),s._v(" "),a("li",[a("p",[s._v("回到宿主机，复制宿主机里的文件到容器中")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/share/zoneinfo/Asia/Shanghai 容器ID或容器名:/usr/share/zoneinfo/Asia\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("进入容器")]),s._v(" "),a("div",{staticClass:"language-shel line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker exec -it 容器Id或容器名\ncp -i /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("此时可以会报错"),a("code",[s._v("cp: not writing through dangling symlink '/etc/localtime'")])]),s._v(" "),a("p",[a("strong",[s._v("解决方法：")])]),s._v(" "),a("p",[s._v("删除容器内的"),a("code",[s._v("/etc/localtime")]),s._v(",重新复制")]),s._v(" "),a("div",{staticClass:"language-rm -rf localtimeshell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rm -rf /etc/localtime\ncp -i /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("date 查看时间")]),s._v(" "),a("p",[s._v("在创建的时候最好填把 localtime 和 timezone 两个文件映射到容器内 "),a("code",[s._v("/etc/localtime")]),s._v(" 和 "),a("code",[s._v("/etc/timezone")])])])]),s._v(" "),a("h2",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[s._v("#")]),s._v(" Nginx")]),s._v(" "),a("h3",{attrs:{id:"挂载目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#挂载目录"}},[s._v("#")]),s._v(" 挂载目录")]),s._v(" "),a("p",[a("code",[s._v("mkdir -p /opt/nginx/{conf,conf.d,html,logs}")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("说明")]),s._v(" "),a("th",[s._v("本机")]),s._v(" "),a("th",[s._v("容器")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("默认配置文件")]),s._v(" "),a("td",[s._v("/opt/nginx/conf/nginx.conf")]),s._v(" "),a("td",[s._v("/etc/nginx/nginx.conf")])]),s._v(" "),a("tr",[a("td",[s._v("其他配置")]),s._v(" "),a("td",[s._v("/opt/nginx/conf.d/")]),s._v(" "),a("td",[s._v("/etc/nginx/conf.d")])]),s._v(" "),a("tr",[a("td",[s._v("日志输出")]),s._v(" "),a("td",[s._v("/opt/nginx/logs")]),s._v(" "),a("td",[s._v("/var/log/nginx")])]),s._v(" "),a("tr",[a("td",[s._v("静态资源")]),s._v(" "),a("td",[s._v("/opt/nginx/html")]),s._v(" "),a("td",[s._v("/usr/share/nginx/html")])])])]),s._v(" "),a("h3",{attrs:{id:"创建容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建容器"}},[s._v("#")]),s._v(" 创建容器")]),s._v(" "),a("p",[a("strong",[s._v("注意：先将配置好的 nginx.conf 放到外部挂载的conf目录下")]),s._v("。🍌"),a("a",{attrs:{href:"http://jaredh.cn/pages/4f3ab6/#%E9%BB%98%E8%AE%A4",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx 配置详解"),a("OutboundLink")],1)]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("默认 nginx.conf")]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v("  nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_processes")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_log")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pid")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("events")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default_type")]),s._v("  application"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("octet"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("log_format")]),s._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$status $body_bytes_sent \"$http_referer\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v("        on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tcp_nopush     on;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#gzip  on;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run --name nginx -d -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/nginx/conf/nginx.conf:/etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/nginx/logs:/var/log/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/nginx/conf.d/:/etc/nginx/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/nginx/html:/usr/share/nginx/html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d nginx:1.18\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[s._v("#")]),s._v(" Jenkins")]),s._v(" "),a("h3",{attrs:{id:"挂载目录-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#挂载目录-2"}},[s._v("#")]),s._v(" 挂载目录")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("说明")]),s._v(" "),a("th",[s._v("本机")]),s._v(" "),a("th",[s._v("容器")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("工作目录")]),s._v(" "),a("td",[s._v("/opt/jenkins_home")]),s._v(" "),a("td",[s._v("/var/jenkins_home")])]),s._v(" "),a("tr",[a("td",[s._v("时区")]),s._v(" "),a("td",[s._v("/etc/timezone")]),s._v(" "),a("td",[s._v("/etc/timezone")])]),s._v(" "),a("tr",[a("td",[s._v("时间")]),s._v(" "),a("td",[s._v("/etc/localtime")]),s._v(" "),a("td",[s._v("/etc/localtime")])])])]),s._v(" "),a("h3",{attrs:{id:"创建容器-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建容器-2"}},[s._v("#")]),s._v(" 创建容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run --name jenkins_wiki "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v(":8080 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10241")]),s._v(":50000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/jenkins_home:/var/jenkins_home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/timezone:/etc/timezone "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/localtime:/etc/localtime  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d jenkins/jenkins:lts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),a("p",[a("strong",[s._v("报错 : 权限问题")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("Can not "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" to /var/jenkins_home/copy_reference_file.log. Wrong volume permissions?\ntouch: cannot "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" ‘/var/jenkins_home/copy_reference_file.log’: Permission denied\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("原因是Jenkins镜像内部使用的用户是jenkons，但是我们启动容器时的账号是root，导致没有权限操作内部目录，我们可以稍微改一下上面的命令：")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run --name jenkins_wiki  -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10241")]),s._v(":50000 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/jenkins_home:/var/jenkins_home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /etc/timezone:/etc/timezone "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /etc/localtime:/etc/localtime "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-u "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v(" -d jenkins/jenkins:lts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("这里 -u 1001 的意思是覆盖容器内部的账号，引用 id为1001的账号")])]),s._v(" "),a("h2",{attrs:{id:"redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[s._v("#")]),s._v(" Redis")]),s._v(" "),a("h3",{attrs:{id:"挂载目录-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#挂载目录-3"}},[s._v("#")]),s._v(" 挂载目录")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("说明")]),s._v(" "),a("th",[s._v("本机")]),s._v(" "),a("th",[s._v("容器")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("配置文件目录")]),s._v(" "),a("td",[s._v("/opt/redis/conf")]),s._v(" "),a("td",[s._v("/var/jenkins_home")])]),s._v(" "),a("tr",[a("td",[s._v("数据目录")]),s._v(" "),a("td",[s._v("/opt/redis/data")]),s._v(" "),a("td",[s._v("/etc/timezone")])])])]),s._v(" "),a("h3",{attrs:{id:"创建容器-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建容器-3"}},[s._v("#")]),s._v(" 创建容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run --name myredis "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 --restart always -d --privileged"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/redis/conf/redis.conf:/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /opt/redis/data:/data  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nredis redis-server /etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--appendonly "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[s._v("#")]),s._v(" 说明")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("-d                                                  -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 以守护进程的方式启动容器\n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379                                        -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 绑定宿主机端口\n--name myredis                                      -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 指定容器名称\n--restart always                                    -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 开机启动\n--privileged"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true                                   -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 提升容器内权限\n-v /opt/redis/conf:/etc/redis/redis.conf    \t\t\t\t-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 映射配置文件\n-v /opt/redis/data:/data                    \t\t\t\t-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 映射数据目录\n--appendonly "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("                                    -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 开启数据持久化\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);