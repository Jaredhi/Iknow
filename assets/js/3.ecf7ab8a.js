(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{417:function(s,t,a){s.exports=a.p+"assets/img/AdvantagesofDocker.41a9139e.png"},418:function(s,t,a){s.exports=a.p+"assets/img/dockercompose.6ee6d71b.png"},419:function(s,t,a){s.exports=a.p+"assets/img/aliyun01.6c2e54c7.png"},420:function(s,t,a){s.exports=a.p+"assets/img/aliyun02.2b051f8e.png"},421:function(s,t,a){s.exports=a.p+"assets/img/aliyun03.76d17856.png"},422:function(s,t,a){s.exports=a.p+"assets/img/dockercommand.9dd2f5c9.png"},423:function(s,t,a){s.exports=a.p+"assets/img/dockercommand2.921be62e.png"},424:function(s,t,a){s.exports=a.p+"assets/img/protainer.5d731fd1.png"},425:function(s,t,a){s.exports=a.p+"assets/img/dockerMirrorloadingprinciple.8287799b.png"},426:function(s,t,a){s.exports=a.p+"assets/img/hierarchy.2c0ced6f.png"},427:function(s,t,a){s.exports=a.p+"assets/img/hierarchy02.cb21edce.png"},428:function(s,t,a){s.exports=a.p+"assets/img/hierarchy03.8e7c6f7f.png"},429:function(s,t,a){s.exports=a.p+"assets/img/hierarchy04.095241d3.png"},430:function(s,t,a){s.exports=a.p+"assets/img/hierarchy05.8cfe7de4.png"},431:function(s,t,a){s.exports=a.p+"assets/img/volume01.df346daf.png"},432:function(s,t,a){s.exports=a.p+"assets/img/volume02.1c74552f.png"},433:function(s,t,a){s.exports=a.p+"assets/img/dockerfile01.c8821812.png"},434:function(s,t,a){s.exports=a.p+"assets/img/dockerfile02.4e4fb1e1.png"},435:function(s,t,a){s.exports=a.p+"assets/img/dockerbuild.4fae0ad2.png"},436:function(s,t,a){s.exports=a.p+"assets/img/DockerFileinstruct.58c7833c.png"},437:function(s,t,a){s.exports=a.p+"assets/img/aliyun_dockerhub.cfb50965.png"},438:function(s,t,a){s.exports=a.p+"assets/img/dockercompose02.a94f61b3.png"},439:function(s,t,a){s.exports=a.p+"assets/img/docker0.82303de2.png"},440:function(s,t,a){s.exports=a.p+"assets/img/docker0_02.67eabd97.png"},441:function(s,t,a){s.exports=a.p+"assets/img/docker0_03.8238131a.png"},442:function(s,t,a){s.exports=a.p+"assets/img/dockernetwork01.6fa2b765.png"},443:function(s,t,a){s.exports=a.p+"assets/img/dockernetwork02.ad14bbb3.png"},444:function(s,t,a){s.exports=a.p+"assets/img/dockernetwork03.67d6b325.png"},445:function(s,t,a){s.exports=a.p+"assets/img/dockerredis.2fd17abb.png"},518:function(s,t,a){"use strict";a.r(t);var n=a(21),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"docker简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker简介"}},[s._v("#")]),s._v(" Docker简介")]),s._v(" "),n("hr"),s._v(" "),n("blockquote",[n("p",[s._v("Docker 是一个开源的应用容器引擎，基于"),n("strong",[s._v("Go语言")]),s._v("并遵从 Apache2.0 协议开源。")]),s._v(" "),n("p",[s._v("Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。")]),s._v(" "),n("p",[s._v("容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。")])]),s._v(" "),n("h2",{attrs:{id:"应用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[s._v("#")]),s._v(" 应用场景")]),s._v(" "),n("ul",[n("li",[s._v("Web 应用的自动化打包和发布。")]),s._v(" "),n("li",[s._v("自动化测试和持续集成、发布。")]),s._v(" "),n("li",[s._v("在服务型环境中部署和调整数据库或其他的后台应用。")]),s._v(" "),n("li",[s._v("从头编译或者扩展现有的 OpenShift 或 Cloud Foundry 平台来搭建自己的 PaaS 环境。")])]),s._v(" "),n("h2",{attrs:{id:"优点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[s._v("#")]),s._v(" 优点")]),s._v(" "),n("p",[n("img",{attrs:{src:a(417),alt:""}})]),s._v(" "),n("h1",{attrs:{id:"docker安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker安装"}},[s._v("#")]),s._v(" Docker安装")]),s._v(" "),n("h2",{attrs:{id:"基本组成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基本组成"}},[s._v("#")]),s._v(" 基本组成")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("镜像（Image）")]),s._v("：就相当于是一个 模板。通过这个模板（镜像）可以创建多个容器。")]),s._v(" "),n("li",[n("strong",[s._v("容器（Container）")]),s._v("：容器可以被创建、启动、停止、删除、暂停等。可以理解为一个简易的Linux系统")]),s._v(" "),n("li",[n("strong",[s._v("仓库（Repository）")]),s._v("：仓库可看成一个代码控制中心，用来保存镜像。")]),s._v(" "),n("li",[n("img",{attrs:{src:a(418),alt:""}})])]),s._v(" "),n("h2",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("环境准备")])]),s._v(" "),n("ol",[n("li",[s._v("CentOS")]),s._v(" "),n("li",[s._v("系统内核 3.10 以上")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uname -r")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-1127.19.1.el7.x86_64\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/os-release ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS Linux"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VERSION")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7 (Core)"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"centos"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID_LIKE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rhel fedora"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VERSION_ID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PRETTY_NAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS Linux 7 (Core)"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ANSI_COLOR")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0;31"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CPE_NAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cpe:/o:centos:centos:7"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOME_URL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://www.centos.org/"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BUG_REPORT_URL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://bugs.centos.org/"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CENTOS_MANTISBT_PROJECT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS-7"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CENTOS_MANTISBT_PROJECT_VERSION")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDHAT_SUPPORT_PRODUCT")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"centos"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDHAT_SUPPORT_PRODUCT_VERSION")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("安装")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("卸载旧版本(建议切换到"),n("strong",[s._v("root")]),s._v("账户进行操作)")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client-latest "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-common "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest-logrotate "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-logrotate "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-engine\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("需要的安装包")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("设置镜像的仓库为阿里云的")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("更新yum软件包索引")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yum makecache fast\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("安装docker，这里安装docker-ce社区版,-ee为企业版")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("启动docker")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("systemctl start docker\nsystemctl start docker.service\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service docker restart 重启")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service docker stop 停止")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable docker.service 设置开机自启")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("查看是否安装")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker version\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("通过运行"),n("code",[s._v("hello-world")]),s._v(" 映像来验证是否正确安装了Docker Engine")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run hello-world\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("输入此命令是会先在本地查找是否有"),n("code",[s._v("hello-world")]),s._v("镜像，如果没有就去远程公共仓库下载测试镜像并在容器中运行它。容器运行时，它会打印参考消息并退出")])])]),s._v(" "),n("p",[n("strong",[s._v("阿里云centos8需要安装依赖：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" https://download.docker.com/linux/fedora/30/x86_64/stable/Packages/containerd.io-1.2.6-3.3.fc30.x86_64.rpm\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("卸载")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("卸载依赖")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yum remove docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("删除资源")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker 的默认工作路径")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])])])]),s._v(" "),n("h2",{attrs:{id:"镜像加速"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#镜像加速"}},[s._v("#")]),s._v(" 镜像加速")]),s._v(" "),n("p",[n("strong",[s._v("使用阿里云镜像加速器")]),s._v("。"),n("a",{attrs:{href:"https://help.aliyun.com/document_detail/60750.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云文档"),n("OutboundLink")],1)]),s._v(" "),n("ol",[n("li",[n("p",[s._v("打开阿里云控制台,选择容器服务")]),s._v(" "),n("img",{staticStyle:{zoom:"67%"},attrs:{src:a(419)}})]),s._v(" "),n("li",[n("p",[s._v("找到容器镜像服务")]),s._v(" "),n("p",[n("img",{attrs:{src:a(420),alt:""}})])]),s._v(" "),n("li",[n("p",[s._v("将操作文档的命令输入到你的机器上")]),s._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:a(421)}})])]),s._v(" "),n("p",[n("strong",[s._v("或者网易加速源")])]),s._v(" "),n("ol",[n("li",[n("p",[n("code",[s._v("vim /etc/docker/daemon.json")]),s._v("  编辑配置文件")])]),s._v(" "),n("li",[n("p",[s._v("加入镜像源地址")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://hub-mirror.c.163.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("重启")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("systemctl daemon-reload\nsystemctl restart docker.service\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])])]),s._v(" "),n("h1",{attrs:{id:"docker-常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-常用命令"}},[s._v("#")]),s._v(" Docker 常用命令")]),s._v(" "),n("h2",{attrs:{id:"帮助命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#帮助命令"}},[s._v("#")]),s._v(" 帮助命令")]),s._v(" "),n("hr"),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker version\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示docker的版本信息")]),s._v("\ndocker info\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示docker的系统信息，包括镜像和容器的数量")]),s._v("\ndocker 命令 --help\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 帮助命令")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"镜像命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#镜像命令"}},[s._v("#")]),s._v(" 镜像命令")]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"查看本地主机上所有的镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看本地主机上所有的镜像"}},[s._v("#")]),s._v(" 查看本地主机上所有的镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker images\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nhello-world         latest              bf756fb1ae65        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" months ago        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像的仓库源\t\t\t\t标签\t\t\t\t\t\t\t\t\tid\t\t\t\t\t\t\t\t\t创建时间\t\t\t\t\t\t大小")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"列出可选项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出可选项"}},[s._v("#")]),s._v(" 列出可选项")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker images --help\n\n-a , --all\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出所有镜像")]),s._v("\n-q ， --quiet\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只显示镜像的id")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"搜索镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#搜索镜像"}},[s._v("#")]),s._v(" 搜索镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker serach "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search mysql")]),s._v("\nNAME        DESCRIPTION                   \t\t\t\t\t\t\tSTARS \t\tOFFICIAL     \t\tAUTO\nMATED\nmysql       MySQL is a widely used, open-source relation…   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10021")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                \nmariadb     MariaDB is a community-developed fork of MyS…   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3673")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                \nmysql/mysql-server  Optimized MySQL Server Docker images.…    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("735")]),s._v("         \t\t\t \t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("           \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选项，通过收藏量来过滤")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search mysql --filter=STARS=3000")]),s._v("\nNAME        DESCRIPTION                                     STARS      OFFICIAL    AUTOMATED\nmysql       MySQL is a widely used, open-source relation…   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10021")]),s._v("   \t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                \nmariadb     MariaDB is a community-developed fork of MyS…   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3673")]),s._v("    \t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 搜索出来的镜像是STARS大于3000的")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h3",{attrs:{id:"下载镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下载镜像"}},[s._v("#")]),s._v(" 下载镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker pull 镜像名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":tag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull mysql")]),s._v("\nUsing default tag: latest\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果不写tag，默认是 latest")]),s._v("\nlatest: Pulling from library/mysql\nd121f8d1c412: Pull complete \t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层下载，docker image的核心 联合文件系统")]),s._v("\nf3cebc0b4691: Pull complete \n1862755a0b37: Pull complete \n489b44f3dbb4: Pull complete \n690874f836db: Pull complete \nbaa8be383ffb: Pull complete \n55356608b4ac: Pull complete \ndd35ceccb6eb: Pull complete \n429b35712b19: Pull complete \n162d8291095c: Pull complete \n5e500ef7181b: Pull complete \naf7528e958b6: Pull complete \nDigest: sha256:e1bfe11693ed2052cb3b4e5fa356c65381129e87e38551c6cd6ec532ebe0e808\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 签名")]),s._v("\nStatus: Downloaded newer image "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mysql:latest\ndocker.io/library/mysql:latest\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 真实地址 相当于 docker pull docker.io/library/mysql:latest")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定版本下载,只能下载仓库中所存在的版本镜像")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull mysql:5.7")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(": Pulling from library/mysql\nd121f8d1c412: Already exists \t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看出，分层下载的优势，不同版本镜像公用的内容不会重新下载")]),s._v("\nf3cebc0b4691: Already exists \n1862755a0b37: Already exists \n489b44f3dbb4: Already exists \n690874f836db: Already exists \nbaa8be383ffb: Already exists \n55356608b4ac: Already exists \n277d8f888368: Pull complete \n21f2da6feb67: Pull complete \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("h3",{attrs:{id:"删除镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除镜像"}},[s._v("#")]),s._v(" 删除镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker rmi -f 镜像id \t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定镜像")]),s._v("\ndocker rmi -f 镜像id 镜像id 镜像id\t\t\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除多个")]),s._v("\ndocker rmi -f "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker images -aq"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" \t \t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除全部")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"容器命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器命令"}},[s._v("#")]),s._v(" 容器命令")]),s._v(" "),n("hr"),s._v(" "),n("p",[n("strong",[s._v("说明：我们有了镜像才可以创建容器，下载一个centos镜像来测试学习")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker pull centos\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"新建容器并启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建容器并启动"}},[s._v("#")]),s._v(" 新建容器并启动")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker run "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("可选参数"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" image\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明")]),s._v("\n--name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),s._v("  容器的名字 Tomcat1 Tomcat2 用来区分容器\n-d      \t\t\t 后台方式运行\n-it\t\t\t\t\t\t 使用交互方式运行，进入容器内查看\n-p\t\t\t\t\t\t 指定容器的端口 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080\n\t\t-p ip:主机端口:容器端口\n\t\t-p 主机端口:容器端口 （常用）\n\t\t-p 容器端口   （没有对外开放端口）\n\t\t端口\n-P   \t\t\t\t（大写P）随机指定端口\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"列出所有运行的容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出所有运行的容器"}},[s._v("#")]),s._v(" 列出所有运行的容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" 命令\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出当前正在运行的容器")]),s._v("\n-a\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出当前正在运行的容器+历史运行过的容器")]),s._v("\n-n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("？ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示前n个最近创建的容器\t\t")]),s._v("\n-q\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只显示容器的编号")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"进入当前正在运行的容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#进入当前正在运行的容器"}},[s._v("#")]),s._v(" 进入当前正在运行的容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器id bashshell\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n1584c3c7dd84        centos              "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" minutes ago      Up "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" minutes                           centos1\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 1584c3c7dd84 /bin/bash")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 /"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 /"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("         PID   "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:13 pts/0    00:00:00 /bin/bash\nroot         "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:26 pts/1    00:00:00 /bin/bash\nroot         "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:26 pts/1    00:00:00 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式二")]),s._v("\ndocker attach 容器id\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker attach 1584c3c7dd84")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 /"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n正在执行当前的代码"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 区别")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec \t进入容器后开启一个新的终端，可以在里面操作(常用)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker attach 进入容器正在执行的终端，不会启动新的进程")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h3",{attrs:{id:"退出容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#退出容器"}},[s._v("#")]),s._v(" 退出容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接退出")]),s._v("\nCtrl + P + Q  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器不停止退出")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"删除容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除容器"}},[s._v("#")]),s._v(" 删除容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 容器id\t\t\t\t\t\t\t\t\t\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定容器，不能删除在运行的容器，除非强制删除 rm -f")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\t\t \t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除所有容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" \t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除所有容器")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"启动和停止容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动和停止容器"}},[s._v("#")]),s._v(" 启动和停止容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker start 容器id\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器 (注意是容器id，不是镜像id)")]),s._v("\ndocker restart 容器id\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启容器")]),s._v("\ndocker stop 容器id\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止当前正在运行的容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 容器id\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制停止当前容器")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"常用其他命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用其他命令"}},[s._v("#")]),s._v(" 常用其他命令")]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"后台启动容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#后台启动容器"}},[s._v("#")]),s._v(" 后台启动容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker run -d 镜像名\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d centos")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时docker ps，发现centos 停止了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 原因：docker容器使用后台运行，就必须要要一个前台进程，docker发现没有应用就会自动停止")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如：nginx容器启动后，发现自己没有提供服务就会立刻停止，就是没有程序了")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"查看日志"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看日志"}},[s._v("#")]),s._v(" 查看日志")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker logs -f -t --tail number 容器id\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选项")]),s._v("\n-tf\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示日志")]),s._v("\n--tail number\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要显示的日志条数")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"查看容器中进程信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看容器中进程信息"}},[s._v("#")]),s._v(" 查看容器中进程信息")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" 容器id\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker top 1584c3c7dd84")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("     PID     "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("     C    STIME       TTY        TIME        CMD\nroot    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("29802")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("29785")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":13       pts/0      00:00:00    /bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"查看镜像的元数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看镜像的元数据"}},[s._v("#")]),s._v(" 查看镜像的元数据")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker inspect 容器id\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect 1584c3c7dd84")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1584c3c7dd84731d6eef626544e511df6799d5dc859e83b0af3a5d5667d500d5"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-10-06T03:54:00.008738938Z"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Path"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Args"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"State"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Status"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"running"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Running"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Paused"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Restarting"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OOMKilled"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Dead"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Pid"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("29802")]),s._v(",\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("h3",{attrs:{id:"从容器内拷贝文件到主机"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从容器内拷贝文件到主机"}},[s._v("#")]),s._v(" 从容器内拷贝文件到主机")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id:容器内路径  目的主机路径\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前目录文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID    IMAGE   COMMAND         CREATED          STATUS      PORTS        NAMES\n1584c3c7dd84    centos  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" minutes ago    Up \t\t\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" minutes \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入docker容器内部")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 1584c3c7dd84 /bin/bash")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 /"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls  ")]),s._v("\nbin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# home目录下创建2.txt文件并拷贝到主机上")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 /"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 home"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 home"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch 2.txt")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 home"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".txt\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1584c3c7dd84 home"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp 1584c3c7dd84:/home/2.txt /home/centos/Downloads")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".txt\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h2",{attrs:{id:"小结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:a(422),alt:""}})]),s._v(" "),n("p",[n("img",{attrs:{src:a(423),alt:""}})]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker stats\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看cpu状态")]),s._v("\ndocker network  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看docke网络")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"练习"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[s._v("#")]),s._v(" 练习")]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"docker-安装nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装nginx"}},[s._v("#")]),s._v(" Docker 安装Nginx")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 搜索镜像")]),s._v("\ndocker search nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 下载镜像")]),s._v("\ndocker pull nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 运行测试")]),s._v("\ndocker run -d --name nginx01 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3344")]),s._v(":80 nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. 访问端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" localhost:3344 \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 出现网页内容即成功，外网访问先检查防火墙和安全组设置是否把对于端口打开。")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"docker-安装tomcat"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装tomcat"}},[s._v("#")]),s._v(" Docker 安装Tomcat")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 官方的使用,一般用来测试，用完就删")]),s._v("\ndocker run -it --rm tomcat:9.0\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 下载 ")]),s._v("\ndocker pull tomcat:9.0\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 启动运行")]),s._v("\ndocker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3355")]),s._v(":8080 --name tomcat01 tomcat\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. 测试访问，可能出现404 ，原因是镜像默认是最小运行环境，webapps没有东西。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat01 /bin/bash")]),s._v("\nroot@c72f33a3eec6:/usr/local/tomcat"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nBUILDING.txt     LICENSE  README.md      RUNNING.txt  conf  logs            temp     webapps.dist\nCONTRIBUTING.md  NOTICE   RELEASE-NOTES  bin          lib   native-jni-lib  webapps  work\nroot@c72f33a3eec6:/usr/local/tomcat"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd webapps")]),s._v("\nroot@c72f33a3eec6:/usr/local/tomcat/webapps"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nroot@c72f33a3eec6:/usr/local/tomcat/webapps"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发现没有东西,然后将webapps.dist下的默认网页复制到webapps中")]),s._v("\nroot@c72f33a3eec6:/usr/local/tomcat/webapps"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp ../webapps.dist/* -r ./")]),s._v("\nroot@c72f33a3eec6:/usr/local/tomcat/webapps"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\nroot@c72f33a3eec6:/usr/local/tomcat/webapps"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nROOT  docs  examples  host-manager  manager\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后访问成功出现Tomcat")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("p",[n("strong",[s._v("思考")]),s._v("： 修改项目每次都要进入容器，十分麻烦。是否可以提供一个映射路径到容器外部，在外部放置项目就自动同步到内部？")]),s._v(" "),n("h4",{attrs:{id:"部署es-kibana"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署es-kibana"}},[s._v("#")]),s._v(" 部署es+kibana")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 暴露的端口很多")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 十分耗内存 1.xG")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es 的数据一般需要放置到安全目录！挂载")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --net somenetwork？ 网络配置")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 启动 elasticsearch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意： 需要设置es启动的内存限制，否则会卡死。除非物理机配置好")]),s._v("\ndocker run -d --name elasticsearch01 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 -e "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xms64m -Xmx512m"')]),s._v(" elasticsearch:7.6.2\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 测试es是否成功")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" localhost:9200\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h2",{attrs:{id:"可视化面版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#可视化面版"}},[s._v("#")]),s._v(" 可视化面版")]),s._v(" "),n("ul",[n("li",[s._v("portainer（先用这个）")]),s._v(" "),n("li",[s._v("Rancher（CI/CD 再用）")])]),s._v(" "),n("p",[n("strong",[s._v("什么是portainer？")])]),s._v(" "),n("p",[s._v("Docker图形化界面管理工具！ 提供一个后台面板供我们操作！")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v(":9000 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always -v /var/run/docker.sock:/var/run/docker.sock --privileged"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true portainer/portainer\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("测试 ip:8088,进去之后就可以进行相关的操作了")]),s._v(" "),n("p",[n("img",{attrs:{src:a(424),alt:""}})]),s._v(" "),n("p",[s._v("一般不会用！")]),s._v(" "),n("h1",{attrs:{id:"docker-镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-镜像"}},[s._v("#")]),s._v(" Docker 镜像")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"镜像是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#镜像是什么"}},[s._v("#")]),s._v(" 镜像是什么")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。")]),s._v(" "),n("p",[s._v("所有的应用，直接打包docker镜像，就可以直接跑起来 !")]),s._v(" "),n("h2",{attrs:{id:"镜像加载原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#镜像加载原理"}},[s._v("#")]),s._v(" 镜像加载原理")]),s._v(" "),n("hr"),s._v(" "),n("blockquote",[n("p",[s._v("unionrs（联合文件系统）")])]),s._v(" "),n("p",[n("strong",[s._v("UnionFS（联合文件系统）"),n("strong",[s._v("∶Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一")]),s._v("层层的叠加")]),s._v("，同时可以将不同目录挂载到同一个虚拟文件系统下（unite several dretries into a single virtual filesystem。Union文件系统是Docker镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。")]),s._v(" "),n("p",[n("strong",[s._v("特性")]),s._v("∶一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包合所有底层的文件和目录")]),s._v(" "),n("blockquote",[n("p",[s._v("Docke镜像加载原理")])]),s._v(" "),n("p",[s._v("docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS.")]),s._v(" "),n("p",[s._v("**bootfs (boot fie ystem）**主要包含bootloader和kernel，bootloader主要是引导加载kernel，LInux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Uni系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。")]),s._v(" "),n("p",[n("strong",[s._v("rootfs（rot filesystem）")]),s._v("，在bootfs之上。包含的就是典型Linux系统中的/dev，/proc，/bin，/etc等标准目录和文件。rots就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。\n"),n("img",{attrs:{src:a(425),alt:""}}),s._v("\n平时我们安装进虚拟机的CentOS都是好几个G，而Docker这里才200M")]),s._v(" "),n("p",[s._v("对于一个精简的OS，rootfs可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版boots基本是一致的，rootfs会有差别，因此不同的发行版可以公用bootfs。")]),s._v(" "),n("h2",{attrs:{id:"分层的理解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#分层的理解"}},[s._v("#")]),s._v(" 分层的理解")]),s._v(" "),n("hr"),s._v(" "),n("blockquote",[n("p",[s._v("分层的镜像")])]),s._v(" "),n("p",[s._v("我们可以去下载一个镜像，注意观察下载的日志输出，可以看到是一层一层的在下载")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull mysql")]),s._v("\nUsing default tag: latest\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果不写tag，默认是 latest")]),s._v("\nlatest: Pulling from library/mysql\nd121f8d1c412: Pull complete \t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层下载，docker image的核心 联合文件系统")]),s._v("\nf3cebc0b4691: Pull complete \n1862755a0b37: Pull complete \n489b44f3dbb4: Pull complete \n690874f836db: Pull complete \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[n("strong",[s._v("思考")]),s._v("∶为什么Docker镜像要采用这种分层的结构呢∶")]),s._v(" "),n("p",[s._v("最大的好处，是资源共享了! 比如有多个镜像都从相同的Base镜像构建而来，那么宿主机只需在磁盘上保留一份base 镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。")]),s._v(" "),n("p",[s._v("查看镜像分层的方式可以通过 "),n("code",[s._v("docker image inspect")]),s._v("命令")]),s._v(" "),n("p",[n("strong",[s._v("理解：")]),s._v("\n所有的Docker 镜像都起始于一个"),n("strong",[s._v("基础镜像层")]),s._v("，当进行修改或增加新的内容时，就会在当前镜像层之上，创建新的镜像层。举一个简单的例子，假如基于Ubuntu Linux16.04 创建一个新的镜像，这就是新镜像的第一层;如果在该镜像中添加Python包，就会在基础镜像层之上创建第二个镜像层;如果继续添加一个安全补丁，就会创建第三个镜像层。该镜像当前已经包含3个镜像层，如下图所示（这只是一个用于演示的很简单的例子）。\n"),n("img",{attrs:{src:a(426),alt:""}}),s._v("\n在添加额外的镜像层的同时，镜像始终保持是当前所有镜像的组合，理解这一点非常重要。")]),s._v(" "),n("p",[s._v("下图中举了一个简单的"),n("strong",[s._v("例子")]),s._v("，")]),s._v(" "),n("ul",[n("li",[s._v("每个镜像层包含3个文件，而镜像包含了来自两个镜像层的6个文件")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(427),alt:""}})]),s._v(" "),n("p",[s._v("上图中的镜像层跟之前图中的略有区别，主要目的是便于展示文件。")]),s._v(" "),n("p",[s._v("下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有6个文件，这是因为上层中的文件7是文件5的一个更新版")]),s._v(" "),n("p",[n("img",{attrs:{src:a(428),alt:""}}),s._v("\n这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新镜像层添加到镜像当中。Docker通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统一的文件系统。")]),s._v(" "),n("p",[n("strong",[s._v("Linux")]),s._v(" 上可用的存储引擎有AUFS、Overlay2、Device Mper、Brfs以及ZFS。顾名思义，每种存储引擎都基于Linux中对应的文件系统或者块设备技术，并且每种存储引擎都有其独有的性能特点。")]),s._v(" "),n("p",[s._v("Docker在"),n("strong",[s._v("Windows")]),s._v("上仅支持windowsfilter 一种存储引擎，该引擎基于NTFS文件系统之上实现了分层和CoW。")]),s._v(" "),n("p",[s._v("下图展示了与系统显示相同的三层镜像。所有镜像层堆叠合并，对外提供统一的视图。")]),s._v(" "),n("img",{staticStyle:{zoom:"150%"},attrs:{src:a(429)}}),s._v(" "),n("ul",[n("li",[n("p",[s._v("特点")]),s._v(" "),n("p",[s._v("Docker镜像都是只读的，当容器启动时，一个可写层被加载到镜像的顶部!")]),s._v(" "),n("p",[s._v("这一层就是我们通常说的容器层，容器层之下的都叫镜像层!")]),s._v(" "),n("p",[n("img",{attrs:{src:a(430),alt:""}})])])]),s._v(" "),n("h2",{attrs:{id:"commit-镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#commit-镜像"}},[s._v("#")]),s._v(" Commit 镜像")]),s._v(" "),n("hr"),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker commit -m"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"提交的描述"')]),s._v(" -a"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"作者"')]),s._v(" 容器id 目标镜像名:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TAG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交容器成为一个新的副本")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 启动一个默认的tomcat")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 因为官方镜像默认webapps下面是没有文件的，需要从webapps.dist下拷贝过去")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 将我们操作过的容器通过commit提交为一个镜像!")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker commit -m="add webapps" -a="JInterst"  05ee7e31d618 tomcat01:1.0')]),s._v("\nsha256:97a7217b0fe4cb4473771b7aa0ff81ba793a0a209106bd124528bf046ce07c11\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost Downloads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY            TAG                 IMAGE ID            CREATED             SIZE\ntomcat01              "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("                 97a7217b0fe4        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" seconds ago      652MB\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h1",{attrs:{id:"容器数据卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器数据卷"}},[s._v("#")]),s._v(" 容器数据卷")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"什么是容器数据卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是容器数据卷"}},[s._v("#")]),s._v(" 什么是容器数据卷")]),s._v(" "),n("p",[n("strong",[s._v("docker的理念回顾")])]),s._v(" "),n("p",[s._v("将应用打包成一个镜像！")]),s._v(" "),n("p",[s._v("如果数据都在容器中，那么我们删除容器，数据就会丢失！"),n("strong",[s._v("需求: 数据可以持久化")])]),s._v(" "),n("p",[s._v("容器之间可以有一个数据共享的技术! Docker容器中产生的数据，同步到本地！")]),s._v(" "),n("ul",[n("li",[s._v("卷技术！ 目录的挂载，将我们容器内的目录挂载到Linux上面")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(431),alt:""}})]),s._v(" "),n("h2",{attrs:{id:"使用数据卷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用数据卷"}},[s._v("#")]),s._v(" 使用数据卷")]),s._v(" "),n("blockquote",[n("p",[s._v("方式一：直接使用命令来挂载 -v")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker run it -v 主机目录:容器内目录\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试 ")]),s._v("\ndocker run -it -v /home/test:/home centos /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动后，新建连接窗口查看 docker信息")]),s._v("\ndocker inspect 容器id\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("img",{staticStyle:{zoom:"150%"},attrs:{src:a(432)}}),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在容器/home下创建文件，主机挂载位置 /home/test 也有这个文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭容器，然后再主机修改这个文件内容，容器再次开启也会同步")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("好处：以后修改只需要在本地修改即可，容器内会自动同步！")])]),s._v(" "),n("h2",{attrs:{id:"实战-安装mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实战-安装mysql"}},[s._v("#")]),s._v(" 实战：安装MySQL")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("思考： MySQL的数据持久化问题")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 获取镜像")]),s._v("\ndocker pull mysql:5.7\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行容器需要做数据挂载, 安装启动mysql需要配置密码！！！")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 官方文档：  docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 相关解释")]),s._v("\n-d \t\t\t后台启动\n-p \t\t\t端口启动\n-v \t\t\t卷挂载\n-e \t\t\t环境配置\n--name  容器名字\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 启动命令")]),s._v("\ndocker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3310")]),s._v(":3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" --name mysql01 mysql:5.7\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 可视化工具连接测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. 创建一个数据库，查看映射路径是否ok！")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5. 如果把容器删除，会发现我们挂载到本地的数据卷依旧没有丢失。")]),s._v("\n\n这就实现了容器数据持久化功能！！！\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h2",{attrs:{id:"具名挂载和匿名挂载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#具名挂载和匿名挂载"}},[s._v("#")]),s._v(" 具名挂载和匿名挂载")]),s._v(" "),n("hr"),s._v(" "),n("p",[n("strong",[s._v("1.  匿名挂载")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\n-v 容器内路径\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name nginx-testniming -v /etc/nginx nginx")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有volume(数据卷)的情况")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER              VOLUME NAME\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("               2ddf9a6442bd6fce51f0d61450801abb98c29d6a4627c2d1209321bf97e25f02\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里发现这种就是匿名挂载，我们在 -v 只写了容器内的路径，没有写容器外的路径！")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("**2. 具名挂载 **")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\n-v 卷名:容器内路径\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name nginx-testjuming -v juming-nginx:/etc/nginx nginx")]),s._v("\ne7a90fbb588b139352aaa9090cca4abff35fd23b839faa22c345c63e7c47c489\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER              VOLUME NAME\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("               2ddf9a6442bd6fce51f0d61450801abb98c29d6a4627c2d1209321bf97e25f02\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("               juming-nginx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过命令查看一下这个卷")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume inspect juming-nginx")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CreatedAt"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-10-07T13:42:48+08:00"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mountpoint"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/juming-nginx/_data"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"juming-nginx"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /var/lib/docker/volumes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost volumes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n2ddf9a6442bd6fce51f0d61450801abb98c29d6a4627c2d1209321bf97e25f02  juming-nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[n("strong",[s._v("以上测试可以得出：")])]),s._v(" "),n("ul",[n("li",[s._v("所有的docker容器内的卷，没有指定目录的情况下多少在"),n("code",[s._v("/var/lib/docker/volumes/xxxx/_data")]),s._v(" 也就是docker工作目录的volumes下")]),s._v(" "),n("li",[s._v("我们通常使用"),n("strong",[s._v("具名挂载")]),s._v("可以方便的找到我们的一个卷")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如何确定是具名挂载还是匿名挂载，还是指定路径挂载")]),s._v("\n-v 容器内路径\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匿名挂载")]),s._v("\n-v 卷名:容器内路径\t\t\t \t\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 具名挂载")]),s._v("\n-v /宿主机路径:容器内路径\t\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定路径挂载")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("strong",[s._v("拓展：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 -v 容器内路径:ro rw 改变读写权限")]),s._v("\nro "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("readonly")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只读")]),s._v("\nrw readwrite "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可读可写")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一旦这个设置了容器的权限，容器对我们挂载出来的内容就有限定了！")]),s._v("\ndocker run -d -P --name nginx-testjuming-ro -v juming-nginx-ro:/etc/nginx:ro nginx\ndocker run -d -P --name nginx-testjuming-ro -v juming-nginx-ro:/etc/nginx:rw nginx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  只要看到ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作的！")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost volumes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name nginx-testjuming-ro -v juming-nginx-ro:/etc/nginx:ro nginx")]),s._v("\n8985777c295e5ccd24956dbe0deb1cfdc5963f87cfa09c6c8d1afd8812dd3a6d\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost volumes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 8985777c295e /bin/bash")]),s._v("\nroot@8985777c295e:/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /etc/nginx")]),s._v("\nroot@8985777c295e:/etc/nginx"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nconf.d  fastcgi_params  koi-utf  koi-win  mime.types  modules  nginx.conf  scgi_params  uwsgi_params  win-utf\nroot@8985777c295e:/etc/nginx"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test-ro.txt")]),s._v("\ntouch: cannot "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test-ro.txt'")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Read-only "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" system\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h2",{attrs:{id:"数据卷容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[s._v("#")]),s._v(" 数据卷容器")]),s._v(" "),n("p",[n("strong",[s._v("容器之间的数据共享")])]),s._v(" "),n("ul",[n("li",[s._v("多个mysql实现数据共享")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3310")]),s._v(":3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" --name mysql01 mysql:5.7\n\ndocker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3311")]),s._v(":3306  -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" --name mysql02 --volumes-form mysql01 mysql:5.7\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("容器之间配置信息的传递，数据卷容器的生命周期一直持续到没有容器使用为止。但是一旦你持久化到了本地，这个时候的数据是不会删除的！")])]),s._v(" "),n("h1",{attrs:{id:"dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),n("h2",{attrs:{id:"初识dockerfile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初识dockerfile"}},[s._v("#")]),s._v(" 初识DockerFile")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("Dockerfile 就是用来构建docker镜像的构建文件！ 命令脚本！")]),s._v(" "),n("p",[s._v("通过这个脚本可以生成镜像，镜像是一层一层的，脚本一个个的命令，每个命令多少一层！")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个dockerfile文件，名字可以随机，建议Dockerfile（build 时默认搜索这个）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件中的内容以 指令（大写）  参数")]),s._v("\nFROM centos\nVOLUME "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume01"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume02"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nCMD "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------end--------"')]),s._v("\nCMD /bin/bash\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这里的每个命令就是镜像的一层")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("img",{attrs:{src:a(433)}}),s._v(" "),n("p",[n("strong",[s._v("启动自己写的容器,会发现有我们生产镜像时自动挂载的数据卷目录")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(434),alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("这个卷和外部有一个同步的目录")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\ndocker inspect 容器id\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到 Mounts")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mounts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"177b9ab51fdab933730f14a9341de3b5893050e028dca24f26f0743f0b97b685"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/177b9ab51fdab933730f14a9341de3b5893050e028dca24f26f0743f0b97b685/_data"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Destination"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume01"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mode"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RW"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Propagation"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aa14d920ca0e1c0b016793423b2561b8b4bd87407cddcd9fd9194af489c0ff47"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/aa14d920ca0e1c0b016793423b2561b8b4bd87407cddcd9fd9194af489c0ff47/_data"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Destination"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume02"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mode"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RW"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Propagation"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("p",[s._v("然后可以测试一下文件是否同步！（文件是拷贝的）")]),s._v(" "),n("h2",{attrs:{id:"基础知识"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础知识"}},[s._v("#")]),s._v(" 基础知识")]),s._v(" "),n("hr"),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("镜像构建步骤")]),s._v("：")]),s._v(" "),n("ol",[n("li",[s._v("编写一个Dockerfile 文件")]),s._v(" "),n("li",[s._v("docker build 构建成为一个镜像")]),s._v(" "),n("li",[s._v("docker run 运行镜像")]),s._v(" "),n("li",[s._v("docker push  发布镜像（DockerHub、阿里云镜像仓库）")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("dockerfile基础知识")]),s._v("：")]),s._v(" "),n("ol",[n("li",[s._v("每个保留关键字（指令）必须是大写字母")]),s._v(" "),n("li",[s._v("按照从上到下的顺序执行")]),s._v(" "),n("li",[n("code",[s._v("#")]),s._v(" 表示注释")]),s._v(" "),n("li",[s._v("每一个指令都会提交一个新的镜像层并提交！")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("回顾")])]),s._v(" "),n("p",[s._v("DockerFile:构建文件，定义了一切步骤，源代码")]),s._v(" "),n("p",[s._v("DockerImages：通过DockerFile构建生成的镜像，最终发布和运行的产品！")]),s._v(" "),n("p",[s._v("Docker容器：容器就是镜像运行起来提供服务的")])])]),s._v(" "),n("p",[n("img",{attrs:{src:a(435),alt:""}})]),s._v(" "),n("h2",{attrs:{id:"dockerfile-指令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-指令"}},[s._v("#")]),s._v(" DockerFile 指令")]),s._v(" "),n("hr"),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("FROM\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基础镜像，一切从这里开始构建")]),s._v("\nMAINTAINER\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像是谁写的，姓名<邮箱>")]),s._v("\nRUN\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像构建的时候需要运行的命令")]),s._v("\nADD\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建镜像需要的内容，可以通过url拉取")]),s._v("\nWORKDIR\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像的工作目录")]),s._v("\nVOLUME\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载的目录")]),s._v("\nEXPOSE\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露端口配置")]),s._v("\nCMD\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定这个容器启动的时候需要运行的命令，只有最后一个会生效，可被替代")]),s._v("\nENTRYPOINT\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定这个容器启动的时候需要运行的命令，可以追加命令")]),s._v("\nONBUILD\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当构建一个被继承 DockerFile 这个时候就会运行 ONBUILD 的指令。触发指令")]),s._v("\nCOPY\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 类似ADD ，将我们的文件拷贝到镜像中")]),s._v("\nENV\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建的时候设置环境变量！")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[n("img",{attrs:{src:a(436),alt:""}})]),s._v(" "),n("h2",{attrs:{id:"实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[s._v("#")]),s._v(" 实战")]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"创建centos镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建centos镜像"}},[s._v("#")]),s._v(" 创建centos镜像")]),s._v(" "),n("hr"),s._v(" "),n("ol",[n("li",[n("p",[s._v("编写Dockerfile的文件")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" jinterest<yx@qq.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" MYPATH /usr/local\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" $MYPATH\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("y install vim\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("y install net"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tools\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" echo $MYPATH\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" echo "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"---------end-----------"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" /bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("通过这个文件构建镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令 注意最后有一个点")]),s._v("\ndocker build -f dockerfile文件路径 -t 镜像名:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 演示")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost docker-test-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -f /home/docker-test-build/dockerfile -t mycentos:1.0 .")]),s._v("\nSending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".048kB\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/10 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM centos\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nSuccessfully built 46329f1b4842\nSuccessfully tagged mycentos:1.0\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出本地进行的变更历史")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost docker-test-build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker history 46329f1b4842")]),s._v("\nIMAGE               CREATED              CREATED BY                                      SIZE                COMMENT\n46329f1b4842        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#(nop)  CMD ["/bin/sh" "-c" "/bin…   0B                  ')]),s._v("\n99cc520c8ece        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#(nop)  CMD ["/bin/sh" "-c" "echo…   0B                  ')]),s._v("\n7d318c99d7f5        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#(nop)  CMD ["/bin/sh" "-c" "echo…   0B                  ')]),s._v("\n6a39fbc1f790        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop)  EXPOSE 80                    0B                  ")]),s._v("\nb484b409738b        About a minute ago   /bin/sh -c yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools             "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(".8MB              \n3058e49f8ed3        About a minute ago   /bin/sh -c yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("                   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("57")]),s._v(".3MB              \n637e642780c7        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop) WORKDIR /usr/local            0B                  ")]),s._v("\nc9b85b2fc51b        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop)  ENV MYPATH=/usr/local        0B                  ")]),s._v("\nc3643b28c128        About a minute ago   /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop)  MAINTAINER jinterest<yx@q…   0B                  ")]),s._v("\n0d120b6ccaa8        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" weeks ago          /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#(nop)  CMD ["/bin/bash"]            0B                  ')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("missing"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" weeks ago          /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop)  LABEL org.label-schema.sc…   0B                  ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("missing"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" weeks ago          /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(nop) ADD file:538afc0c5c964ce0d…   215MB  ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])])])]),s._v(" "),n("h3",{attrs:{id:"tomcat镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tomcat镜像"}},[s._v("#")]),s._v(" Tomcat镜像")]),s._v(" "),n("hr"),s._v(" "),n("ol",[n("li",[n("p",[s._v("准备镜像文件 Tomcat压缩包，jdk压缩包")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost docker-test-tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nDockerfile  jdk-11_linux-x64_bin.tar.gz  readme.txt  tomcat-9.0.38.tar.gz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("编写dockerfile文件,官方命名"),n("code",[s._v("Dockerfile")]),s._v("  ，build会自动寻找这个文件，就不需要要-f指定了！")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" jinterest<yx@qq.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" readme.txt /usr/local/readme.txt\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" jdk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("11_linux"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("x64_bin.tar.gz /usr/local/\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9.0.38.tar.gz /usr/local\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("y install vim\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" MYPATH /usr/local\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" $MYPATH\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" JAVA_HOME /usr/local/jdk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("11\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" CATALINA_HOME /usr/local/apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9.0.38\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" CATALINA_BASH /usr/local/apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9.0.38\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" PATH $PATH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$JAVA_HOME/bin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$CATALINA_HOME/lib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$CATALINA_BASH/bin\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8080\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" /usr/local/apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9.0.38/bin/startup.sh && tail "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("F /usr/local/apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("9.0.38/bin/logs/catalina.out\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("构建镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker build -t diytomcat "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("启动镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v(":8080 --name divtomcat -v /home/docker-test-tomcat/myweb:/usr/local/apache-tomcat-9.0.38/webapps/myweb -v /home/docker-test-tomcat/tomcatlog/:/usr/local/apache-tomcat-9.0.38/logs diytomcat\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("访问测试")])]),s._v(" "),n("li",[n("p",[s._v("发布项目（由于做了卷挂载，我们直接在本地编写项目就可以发布了！）")]),s._v(" "),n("p",[s._v("卷挂载目录下/WEB-INF/web.xml")]),s._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token prolog"}},[s._v('<?xml version="1.0" encoding="UTF-8"?>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("web-app")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("xmlns")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("http://java.sun.com/xml/ns/javaee"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("xmlns:")]),s._v("xsi")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("http://www.w3.org/2001/XMLSchema-instance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("xsi:")]),s._v("schemaLocation")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("http://java.sun.com/xml/ns/javaee\n                             http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("2.5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("web-app")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("卷挂载目录下/index.jsp")]),s._v(" "),n("div",{staticClass:"language-jsp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<%@ page language="java" contentType="text/html; charset=UTF-8"\n    pageEncoding="UTF-8"%>\n<!DOCTYPE html>\n<html>\n<head>\n<meta charset="utf-8">\n<title>hello</title>\n</head>\n<body>\nHello World!<br/>\n<%\nSystem.out.println("666");\n%>\n</body>\n</html>\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])])])]),s._v(" "),n("h2",{attrs:{id:"发布自己的镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布自己的镜像"}},[s._v("#")]),s._v(" 发布自己的镜像")]),s._v(" "),n("h3",{attrs:{id:"dockerhub"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerhub"}},[s._v("#")]),s._v(" DockerHub")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("地址 https://hub.docker.com/ 注册自己的账号")])]),s._v(" "),n("li",[n("p",[s._v("登录")])]),s._v(" "),n("li",[n("p",[s._v("在我们的服务器上提交自己的镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost myweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker login -u 用户名 ")]),s._v("\nPassword: \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("登录完毕就可以提交镜像了"),n("code",[s._v("docker push 作者名字/镜像名字:版本号")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost myweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push diytomcat")]),s._v("\nThe push refers to repository "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/library/diytomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n20a533853737: Preparing \n5248a8b5c507: Preparing \n1d489b172f07: Preparing \n80f59bc7bc59: Preparing \n291f6e44771a: Preparing \ndenied: requested access to the resource is denied "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 被拒绝")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost myweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push jinterest/diytomcat:1.0")]),s._v("\nThe push refers to repository "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/jinterest/diytomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nAn image does not exist locally with the tag: jinterest/diytomcat\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解决，增加一个tag")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost myweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker tag 69cd8018cdd1 jinterest/diytomcat:1.0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后再push就可以了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost myweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push jinterest/diytomcat:1.0")]),s._v("\nThe push refers to repository "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/jinterest/diytomcat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n20a533853737: Pushing "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(".58MB/57.26MB\n5248a8b5c507: Pushing "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(".15MB\n1d489b172f07: Pushing "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".33MB/302.4MB\n80f59bc7bc59: Pushed \n291f6e44771a: Pushing "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".462MB/215.1MB\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交的时候也是按层级提交的 ！！！")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])])])]),s._v(" "),n("h3",{attrs:{id:"阿里云镜像服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#阿里云镜像服务"}},[s._v("#")]),s._v(" 阿里云镜像服务")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("登录阿里云")])]),s._v(" "),n("li",[n("p",[s._v("找到容器镜像服务")])]),s._v(" "),n("li",[n("p",[s._v("创建命名空间")])]),s._v(" "),n("li",[n("p",[s._v("创建容器镜像")])]),s._v(" "),n("li",[n("p",[s._v("按照阿里云文档（很详细）")]),s._v(" "),n("p",[n("img",{attrs:{src:a(437),alt:""}})])])]),s._v(" "),n("h2",{attrs:{id:"小结-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小结-2"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:a(438),alt:""}})]),s._v(" "),n("h1",{attrs:{id:"docker-网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-网络"}},[s._v("#")]),s._v(" Docker 网络")]),s._v(" "),n("hr"),s._v(" "),n("h2",{attrs:{id:"理解docker0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#理解docker0"}},[s._v("#")]),s._v(" 理解Docker0")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("测试")]),s._v("前先清空所有环境")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(439),alt:""}})]),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("问题：docker是如何处理容器网络访问的？")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name tomcat01 tomcat")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器的内部网络地址 ip addr ，发现容器启动的时候会得到一个 eth0@if39 ip地址，docker分配的！")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat01 ip addr")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN group default qlen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo\n       valid_lft forever preferred_lft forever\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v(": eth0@if39: "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    inet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2/16 brd "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("思考：linux能不能ping内部？")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ping 172.17.0.2")]),s._v("\nPING "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.142")]),s._v(" ms\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.083")]),s._v(" ms\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# linux 可以ping通docker容器内部")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("原理")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("我们每启动一个docker容器，docker就会给容器分配一个ip，我们只要安装了docker，就会有一个网卡docker0桥接模式，使用的技术是 "),n("code",[s._v("evth-pair")]),s._v(" 技术！")])]),s._v(" "),n("li",[n("p",[s._v("再次ip addr")]),s._v(" "),n("p",[n("img",{attrs:{src:a(440),alt:""}})])]),s._v(" "),n("li",[n("p",[s._v("再启动一个容器测试，会发现又多了一对网卡！")]),s._v(" "),n("p",[n("img",{attrs:{src:a(441),alt:""}})]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们发现这个容器带来的网卡，都是一对对的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# evth-pair 就是一对的虚拟设备接口，他们都是成对出现的，一段连着协议，一段彼此相连")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 正因为有这个特性，evth-pair 充当一个桥梁，连接各种虚拟网络设备的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# OpenStac ， Docker 容器之间的连接 ，osv 的连接，都是使用 evth-pair 技术")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("我们来测试下 tomcat01 和 tomcat02 是否可以ping通！")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat02 ping 172.17.0.2")]),s._v("\nPING "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2: "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.135")]),s._v(" ms\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 结论：容器和容器之间是可以互相 ping 通的！")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("网络模型图")]),s._v(" "),n("p",[n("img",{attrs:{src:a(442),alt:""}})])])]),s._v(" "),n("p",[n("strong",[s._v("小结")])]),s._v(" "),n("p",[s._v("Docker 使用的是Linux的桥接，宿主机中是一个docker容器的网桥 docker0")]),s._v(" "),n("img",{staticStyle:{zoom:"150%"},attrs:{src:a(443)}}),s._v(" "),n("p",[s._v("docker 中的所有网络接口都是虚拟的。虚拟的转发效率高！（内网传递文件！）")]),s._v(" "),n("p",[s._v("只要删除容器，对应网桥对就没了")])])]),s._v(" "),n("h2",{attrs:{id:"link"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#link"}},[s._v("#")]),s._v(" --link")]),s._v(" "),n("blockquote",[n("p",[s._v("思考一个场景，我们编写了一个微服务，database url=ip∶，项目不重启，数据库ip换掉了，我们希望可以处理这个问题，可以名字用来进行访问容器?")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat02 ping tomcat01")]),s._v("\nping: tomcat01: Name or "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" not known\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如何可以解决呢?")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过--link 既可以解决网络连通问题")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name tomcat03 --link tomcat02 tomcat c4d3b18340f64065dbeb66aad369e74e9966e2a7756978388fbde1fb8109ea9a")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat03 ping tomcat02 ")]),s._v("\nPING tomcat02 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat02 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.193")]),s._v(" ms \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#反向可以ping通吗?")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat02 ping tomcat03")]),s._v("\nping: tomcat03: Name or "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" not known\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("探究")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect bridge")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7391f35d7b39e654d596ad8227db35daf1d48ba06b96689515af96770eaa8675"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat02"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"d5acbe00b2ba92650e124245d022a9a2f2018ce072a632daa1c604ce8e8e9053"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:ac:11:00:03"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.3/16"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7b28e7bae9f3a2841c87b56f552ce9bf193b38c29571f9e2fe67a1865fbb0aba"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat01"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"83fa792f6b78046e90fd6baa97832fcd17f520753fbcffb6fa47730c29ba6e25"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:ac:11:00:02"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.2/16"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"c4d3b18340f64065dbeb66aad369e74e9966e2a7756978388fbde1fb8109ea9a"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat03"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"68f9d4da55807485d9d99635af40d436f16a684ae006c021d6d9b4c7e9aefeeb"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:ac:11:00:04"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.4/16"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 hosts 配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat03 cat /etc/hosts")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3      tomcat02 7391f35d7b39\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.4      c4d3b18340f6\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("本质")]),s._v(" ：--link 就是我们在hosts 配置中增加了一个172.17.0.3      tomcat02 7391f35d7b39")]),s._v(" "),n("p",[s._v("现在docker已经不建议使用--link")]),s._v(" "),n("p",[s._v("自定义网络！不适用于docker0 ！")]),s._v(" "),n("p",[s._v("Docker0 ：不支持容器名连接访问！")])])]),s._v(" "),n("h2",{attrs:{id:"自定义网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义网络"}},[s._v("#")]),s._v(" 自定义网络")]),s._v(" "),n("hr"),s._v(" "),n("p",[n("code",[s._v("docker network --help")]),s._v(" 查看相关命令")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network ls")]),s._v("\nNETWORK ID          NAME                DRIVER              SCOPE\n5914328caba7        bridge              bridge              "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n385fc6f32d02        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nd439a68e0cb8        none                null                "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("网络模式：")])]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("bridge")]),s._v(" ：桥接 docker 默认")]),s._v(" "),n("li",[n("strong",[s._v("none")]),s._v(" ： 不配置网络")]),s._v(" "),n("li",[n("strong",[s._v("host")]),s._v(" ：和宿主机共享网络")]),s._v(" "),n("li",[n("strong",[s._v("container")]),s._v(" ：容器网络连通！ （用的少！局限很大）")])]),s._v(" "),n("p",[n("strong",[s._v("测试：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接启动的命令 --net bridge 就是我们的docker0")]),s._v("\ndocker run -d -P --name tomcat01 tomcat\ndocker run -d -P --name tomcat01 --net bridge tomcat\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker0 特点 ，默认，域名不能访问，--link可以打通连接")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("strong",[s._v("自定义一个网络：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet")]),s._v("\nb2d71a6c424d9a6b89a0e217a51d8b904fc8a9fd0b12f2c07059e080cd0c28e8\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network ls")]),s._v("\nNETWORK ID          NAME                DRIVER              SCOPE\n5914328caba7        bridge              bridge              "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n385fc6f32d02        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nb2d71a6c424d        mynet               bridge              "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nd439a68e0cb8        none                null                "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时自定义网络已经创建好了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect mynet")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynet"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b2d71a6c424d9a6b89a0e217a51d8b904fc8a9fd0b12f2c07059e080cd0c28e8"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-10-07T23:05:20.433433546+08:00"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableIPv6"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPAM"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.0/16"')]),s._v(",\n                    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.1"')]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("p",[n("strong",[s._v("在自定义网络下运行两个容器：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name tomcat-net-01 --net mynet tomcat")]),s._v("\ne3a2df9dae121ef96a076b6cf13cfa2f7038a4c30540c8e1be58d0c58d6c08b9\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name tomcat-net-02 --net mynet tomcat")]),s._v("\n03bf1d68b678cabca6b57ee6f09ff4220f4f52316de92be40ab9d4eaec93f2a3\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect mynet")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynet"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b2d71a6c424d9a6b89a0e217a51d8b904fc8a9fd0b12f2c07059e080cd0c28e8"')]),s._v(",\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.0/16"')]),s._v(",\n                    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.1"')]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"03bf1d68b678cabca6b57ee6f09ff4220f4f52316de92be40ab9d4eaec93f2a3"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat-net-02"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"df8e5496cc8474a237010ed46737728d0f46b4992559763c3bda52d74937042d"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:c0:a8:00:03"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.3/16"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"e3a2df9dae121ef96a076b6cf13cfa2f7038a4c30540c8e1be58d0c58d6c08b9"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat-net-01"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f0db1bd4dfbd86ee6dd00ca451f627b426590e3bf560b2e5d2c4a460e63626ee"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:c0:a8:00:02"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.2/16"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("p",[n("strong",[s._v("此时使用 ping 容器名 可以连接上：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat-net-01 ping tomcat-net-02")]),s._v("\nPING tomcat-net-02 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("84")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" bytes of data.\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat-net-02.mynet "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.051")]),s._v(" ms\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" bytes from tomcat-net-02.mynet "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("icmp_seq")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ttl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("time")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.053")]),s._v(" ms\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("我们自定义的网络docker都已经帮我们维护好了对应的关系，推荐我们平时这样使用网络！！")]),s._v(" "),n("p",[n("strong",[s._v("好处：不同的集群使用不同的网络，保证集群是安全和健康的")])]),s._v(" "),n("h2",{attrs:{id:"网络连通"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络连通"}},[s._v("#")]),s._v(" 网络连通")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("两个不同网络的容器可以使用 "),n("code",[s._v("docker network connect [OPTIONS] NETWORK CONTAINER")]),s._v(" 打通")]),s._v(" "),n("p",[n("strong",[s._v("演示：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network connect mynet tomcat01")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect mynet")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:a(444),alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("连通之后就是将 tomcat01 放到了 mynet 网络下")])]),s._v(" "),n("p",[n("strong",[s._v("一个容器两个 ip 地址 ，类似于公网ip 私网ip")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("root@7b28e7bae9f3:/usr/local/tomcat"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip addr")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN group default qlen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo\n       valid_lft forever preferred_lft forever\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v(": eth0@if39: "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    inet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2/16 brd "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(": eth1@if50: "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default \n    link/ether 02:42:c0:a8:00:04 brd ff:ff:ff:ff:ff:ff link-netnsid "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    inet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.4/16 brd "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".255.255 scope global eth1\n       valid_lft forever preferred_lft forever\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h1",{attrs:{id:"redis集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis集群"}},[s._v("#")]),s._v(" Redis集群")]),s._v(" "),n("hr"),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("shell脚本")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建网卡")]),s._v("\ndocker network create redis --subnet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.0/16 \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#通过脚本创建六个redis配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /mydata/redis/node-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /mydata/redis/node-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF"),n("span",{pre:!0,attrs:{class:"token bash punctuation"}},[s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/mydata/redis/node-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf")]),s._v("\nport 6379\nbind 0.0.0.0\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 5000\ncluster-announce-ip 172.38.0.1"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("\ncluster-announce-port 6379\ncluster-announce-bus-port 16379\nappendonly yes\nEOF")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("port")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker run -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("637")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(":6379 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1637")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(":16379 --name redis-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("-v /mydata/redis/node-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/data:/data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/redis/node-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v("/conf/redis.conf:/etc/redis/redis.conf "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d --net redis --ip "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.1"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v(" redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入redis容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it redis-1 /bin/sh\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建集群")]),s._v("\nredis-cli --cluster create "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.11:6379 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.12:6379 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.13:6379 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.14:6379 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.15:6379 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.16:6379 --cluster-replicas "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("dokcer 搭建redis集群完成！")])])]),s._v(" "),n("img",{staticStyle:{zoom:"150%"},attrs:{src:a(445)}})]),s._v(" "),n("li",[n("p",[s._v("测试")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("/data "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-cli -c")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),n("span",{pre:!0,attrs:{class:"token operator"}},[n("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" a b\n-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Redirected to slot "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15495")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" located at "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.13:6379\nOK\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后再另一个窗口关闭 redis-3")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost centos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker stop redis-3")]),s._v("\nredis-3\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新回到redis容器 ，再次get a，查看是否可以得到数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),n("span",{pre:!0,attrs:{class:"token operator"}},[n("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get a\n-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Redirected to slot "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15495")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" located at "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.38")]),s._v(".0.14:6379\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])])])]),s._v(" "),n("h2",{attrs:{id:"关于mounts-denied解决"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于mounts-denied解决"}},[s._v("#")]),s._v(" 关于Mounts denied解决")]),s._v(" "),n("p",[s._v("在使用Docker镜像redis时映射配置文件和映射数据目录的时候，出现如下错误提示：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker: Error response from daemon: Mounts denied:The paths /docker/redis/data and /docker/redis/redis.conf are not shared from OS X and are not known to Docker.You can configure shared paths from Docker -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Preferences"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" File Sharing.See https://docs.docker.com/docker-for-mac/osxfs/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#namespaces for more info.")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("解决办法：在目录下面-v后面跟的目录使用绝对路径")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 -v "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("/docker/redis/redis.conf:/etc/redis/redis.conf -v "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("/docker/redis/data:/data --name my-redis redis:latest redis-server /etc/redis/redis.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h1",{attrs:{id:"springboot微服务打包docker镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#springboot微服务打包docker镜像"}},[s._v("#")]),s._v(" SpringBoot微服务打包Docker镜像")]),s._v(" "),n("hr"),s._v(" "),n("ol",[n("li",[n("p",[s._v("构建Springboot项目")])]),s._v(" "),n("li",[n("p",[s._v("打包应用")])]),s._v(" "),n("li",[n("p",[s._v("编写dockerfile")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" openjdk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("11.0.4\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" *.jar /app.jar\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--server.port=8080"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8080\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/app.jar"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("构建镜像")])]),s._v(" "),n("li",[n("p",[s._v("发布运行！")])])]),s._v(" "),n("p",[s._v("参考"),n("a",{attrs:{href:"https://www.bilibili.com/video/BV1og4y1q7M4",target:"_blank",rel:"noopener noreferrer"}},[s._v("狂神说"),n("OutboundLink")],1),s._v(" , "),n("a",{attrs:{href:"https://docs.docker.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker官网"),n("OutboundLink")],1),s._v(" , "),n("a",{attrs:{href:"https://www.runoob.com/docker/docker-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("菜鸟教程"),n("OutboundLink")],1)]),s._v(" "),n("h1",{attrs:{id:"docker容器内时间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker容器内时间"}},[s._v("#")]),s._v(" Docker容器内时间")]),s._v(" "),n("blockquote",[n("p",[s._v("docker容器内时间与服务器时间差距8小时，因为原生docker是0时区，但我们服务器采用亚洲上海东八区。")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("首先进入容器 "),n("code",[s._v("docker exec -it /bin/sh")]),s._v(" 查询时间 "),n("code",[s._v("date -R")])])]),s._v(" "),n("li",[n("p",[s._v("创建文件夹"),n("code",[s._v("mkdir -p /usr/share/zoneinfo/Asia")])])]),s._v(" "),n("li",[n("p",[s._v("回到宿主机，复制宿主机里的文件到容器中")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/share/zoneinfo/Asia/Shanghai 容器ID或容器名:/usr/share/zoneinfo/Asia\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("进入容器")]),s._v(" "),n("div",{staticClass:"language-shel line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker exec -it 容器Id或容器名\ncp -i /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("此时可以会报错"),n("code",[s._v("cp: not writing through dangling symlink '/etc/localtime'")])]),s._v(" "),n("p",[n("strong",[s._v("解决方法：")])]),s._v(" "),n("p",[s._v("删除容器内的"),n("code",[s._v("/etc/localtime")]),s._v(",重新复制")]),s._v(" "),n("div",{staticClass:"language-rm -rf localtimeshell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("rm -rf /etc/localtime\ncp -i /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("date 查看时间")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);